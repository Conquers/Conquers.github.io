

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta name="google-site-verification" content="43OxIpGYgslJ9JsYR5EOV8dbGmcU6pabRBqI3QaEv54" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wtt">
  <meta name="keywords" content="">
  
    <meta name="description" content="RedisRedis - è‹±æ–‡å®˜ç½‘Redis - ä¸­æ–‡ç½‘GitHub - redis&#x2F;redis  å‚è€ƒèµ„æ–™è§†é¢‘åœ°å€ï¼šã€ç¼–ç¨‹ä¸è‰¯äººã€‘é€‚åˆåç«¯ç¼–ç¨‹äººå‘˜çš„Rediså®æˆ˜æ•™ç¨‹ã€redisåº”ç”¨åœºæ™¯ã€åˆ†å¸ƒå¼ç¼“å­˜ã€Sessionç®¡ç†ã€é¢è¯•ç›¸å…³ç­‰å·²å®Œç»“!å“”å“©å“”å“©_bilibiliè§†é¢‘åœ°å€ï¼šé»‘é©¬ç¨‹åºå‘˜Rediså…¥é—¨åˆ°å®æˆ˜æ•™ç¨‹ï¼Œæ·±åº¦é€æredisåº•å±‚åŸç†+redisåˆ†å¸ƒå¼é”+ä¼ä¸šè§£å†³æ–¹æ¡ˆ+é»‘é©¬ç‚¹è¯„å®æˆ˜é¡¹ç›®">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis">
<meta property="og:url" content="http://conquers.github.io/posts/bae4ff13.html">
<meta property="og:site_name" content="wtt&#39;s Blog">
<meta property="og:description" content="RedisRedis - è‹±æ–‡å®˜ç½‘Redis - ä¸­æ–‡ç½‘GitHub - redis&#x2F;redis  å‚è€ƒèµ„æ–™è§†é¢‘åœ°å€ï¼šã€ç¼–ç¨‹ä¸è‰¯äººã€‘é€‚åˆåç«¯ç¼–ç¨‹äººå‘˜çš„Rediså®æˆ˜æ•™ç¨‹ã€redisåº”ç”¨åœºæ™¯ã€åˆ†å¸ƒå¼ç¼“å­˜ã€Sessionç®¡ç†ã€é¢è¯•ç›¸å…³ç­‰å·²å®Œç»“!å“”å“©å“”å“©_bilibiliè§†é¢‘åœ°å€ï¼šé»‘é©¬ç¨‹åºå‘˜Rediså…¥é—¨åˆ°å®æˆ˜æ•™ç¨‹ï¼Œæ·±åº¦é€æredisåº•å±‚åŸç†+redisåˆ†å¸ƒå¼é”+ä¼ä¸šè§£å†³æ–¹æ¡ˆ+é»‘é©¬ç‚¹è¯„å®æˆ˜é¡¹ç›®">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://conquers.github.io/Resources/banner-redis.png">
<meta property="article:published_time" content="2022-06-18T08:30:15.000Z">
<meta property="article:modified_time" content="2023-06-06T00:30:15.000Z">
<meta property="article:author" content="wtt">
<meta property="article:tag" content="Redis">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://conquers.github.io/Resources/banner-redis.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Redis - wtt&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/mac.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"conquers.github.io","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="wtt's Blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wtt&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Redis"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-06-18 16:30" pubdate>
          2022å¹´6æœˆ18æ—¥ ä¸‹åˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          30k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          251 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Redis</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><p><a target="_blank" rel="noopener" href="https://redis.io/">Redis - è‹±æ–‡å®˜ç½‘</a><br><a target="_blank" rel="noopener" href="http://www.redis.cn/">Redis - ä¸­æ–‡ç½‘</a><br><a target="_blank" rel="noopener" href="https://github.com/redis/redis">GitHub - redis&#x2F;redis</a></p>
<blockquote>
<p>å‚è€ƒèµ„æ–™<br>è§†é¢‘åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1jD4y1Q7tU">ã€ç¼–ç¨‹ä¸è‰¯äººã€‘é€‚åˆåç«¯ç¼–ç¨‹äººå‘˜çš„Rediså®æˆ˜æ•™ç¨‹ã€redisåº”ç”¨åœºæ™¯ã€åˆ†å¸ƒå¼ç¼“å­˜ã€Sessionç®¡ç†ã€é¢è¯•ç›¸å…³ç­‰å·²å®Œç»“!å“”å“©å“”å“©_bilibili</a><br>è§†é¢‘åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1cr4y1671t">é»‘é©¬ç¨‹åºå‘˜Rediså…¥é—¨åˆ°å®æˆ˜æ•™ç¨‹ï¼Œæ·±åº¦é€æredisåº•å±‚åŸç†+redisåˆ†å¸ƒå¼é”+ä¼ä¸šè§£å†³æ–¹æ¡ˆ+é»‘é©¬ç‚¹è¯„å®æˆ˜é¡¹ç›®_å“”å“©å“”å“©_bilibili</a><br>å‚è€ƒç¬”è®°ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/unique_perfect/article/details/105515137">ä»å‰æ…¢-Redis_unique_perfectçš„åšå®¢-CSDNåšå®¢</a></p>
<p>ä»£ç å‚è€ƒï¼šredis-study</p>
</blockquote>
<h2 id="1ã€Nosqlçš„å¼•è¨€"><a href="#1ã€Nosqlçš„å¼•è¨€" class="headerlink" title="1ã€Nosqlçš„å¼•è¨€"></a>1ã€Nosqlçš„å¼•è¨€</h2><p>NoSQLï¼ˆNot Only SQLï¼‰ï¼Œæ„å³ä¸ä»…ä»…æ˜¯SQLï¼Œæ³›æŒ‡éå…³ç³»å‹çš„æ•°æ®åº“ã€‚Nosqlè¿™ä¸ªæŠ€æœ¯é—¨ç±»ï¼Œæ—©æœŸå°±æœ‰äººæå‡ºï¼Œå‘å±•è‡³2009å¹´è¶‹åŠ¿è¶Šå‘é«˜æ¶¨ã€‚</p>
<blockquote>
<p>RDBMSï¼šå…³ç³»å‹æ•°æ®åº“<br>NOSQLï¼šï¼ˆæ³›æŒ‡ï¼‰éå…³ç³»å‹æ•°æ®åº“<br>RDBMSå’ŒNOSQLç›¸è¾…ç›¸æˆ</p>
</blockquote>
<h2 id="2ã€ä¸ºä»€ä¹ˆæ˜¯NoSQL"><a href="#2ã€ä¸ºä»€ä¹ˆæ˜¯NoSQL" class="headerlink" title="2ã€ä¸ºä»€ä¹ˆæ˜¯NoSQL"></a>2ã€ä¸ºä»€ä¹ˆæ˜¯NoSQL</h2><p>éšç€äº’è”ç½‘ç½‘ç«™çš„å…´èµ·ï¼Œä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“åœ¨åº”ä»˜åŠ¨æ€ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯è¶…å¤§è§„æ¨¡å’Œé«˜å¹¶å‘çš„çº¯åŠ¨æ€ç½‘ç«™å·²ç»æ˜¾å¾—åŠ›ä¸ä»æš´éœ²äº†å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ã€‚å¦‚<strong>å•†åŸç½‘ç«™ä¸­å¯¹å•†å“æ•°æ®é¢‘ç¹æŸ¥è¯¢</strong>ã€<strong>å¯¹çƒ­æœå•†å“çš„æ’è¡Œç»Ÿè®¡</strong>ã€<strong>è®¢å•è¶…æ—¶é—®é¢˜</strong>ã€ä»¥åŠ<strong>å¾®ä¿¡æœ‹å‹åœˆï¼ˆéŸ³é¢‘ï¼Œè§†é¢‘ã€‰å­˜å‚¨</strong>ç­‰ç›¸å…³ä½¿ç”¨ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å®ç°å°±æ˜¾å¾—éå¸¸å¤æ‚ï¼Œè™½ç„¶èƒ½å®ç°ç›¸åº”åŠŸèƒ½ä½†æ˜¯åœ¨æ€§èƒ½ä¸Šå´ä¸æ˜¯é‚£ä¹ˆä¹è§‚ã€‚nosqlè¿™ä¸ªæŠ€æœ¯é—¨ç±»çš„å‡ºç°ï¼Œæ›´å¥½çš„è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œå®ƒå‘Šè¯‰äº†ä¸–ç•Œä¸ä»…ä»…æ˜¯sqlã€‚</p>
<h2 id="3ã€NoSQLçš„å››å¤§åˆ†ç±»"><a href="#3ã€NoSQLçš„å››å¤§åˆ†ç±»" class="headerlink" title="3ã€NoSQLçš„å››å¤§åˆ†ç±»"></a>3ã€NoSQLçš„å››å¤§åˆ†ç±»</h2><h4 id="3-1-é”®å€¼-Key-Value-å­˜å‚¨æ•°æ®åº“"><a href="#3-1-é”®å€¼-Key-Value-å­˜å‚¨æ•°æ®åº“" class="headerlink" title="3.1 é”®å€¼(Key-Value)å­˜å‚¨æ•°æ®åº“"></a>3.1 é”®å€¼(Key-Value)å­˜å‚¨æ•°æ®åº“</h4><ul>
<li><p>è¯´æ˜:<br>è¿™ä¸€ç±»æ•°æ®åº“ä¸»è¦ä¼šä½¿ç”¨åˆ°ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œè¿™ä¸ªè¡¨ä¸­æœ‰ä¸€ä¸ªç‰¹å®šçš„é”®å’Œä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ç‰¹å®šçš„æ•°æ®ã€‚<br><code>Map&lt;key,value&gt;</code></p>
</li>
<li><p>ç‰¹ç‚¹<br>ä¼˜ç‚¹ï¼šKey&#x2F;valueæ¨¡å‹å¯¹äºITç³»ç»Ÿæ¥è¯´çš„ä¼˜åŠ¿åœ¨äºç®€å•ã€æ˜“éƒ¨ç½²ã€‚<br>ç¼ºç‚¹ï¼šå¦‚æœDBAï¼ˆæ•°æ®åº“ç®¡ç†å‘˜ï¼‰åªå¯¹éƒ¨åˆ†å€¼è¿›è¡ŒæŸ¥è¯¢æˆ–æ›´æ–°çš„æ—¶å€™ï¼ŒKey&#x2F;valueå°±æ˜¾å¾—æ•ˆç‡ä½ä¸‹äº†ã€‚</p>
</li>
<li><p>ç›¸å…³äº§å“</p>
<ul>
<li>Tokyo Cabinet&#x2F;Tyrant</li>
<li><strong>Redis</strong>  å†…å­˜</li>
<li><strong>SSDB</strong>  ç¡¬ç›˜</li>
<li>Voldemort </li>
<li>Oracle BDB</li>
</ul>
</li>
</ul>
<h4 id="3-2-åˆ—å­˜å‚¨æ•°æ®åº“"><a href="#3-2-åˆ—å­˜å‚¨æ•°æ®åº“" class="headerlink" title="3.2 åˆ—å­˜å‚¨æ•°æ®åº“"></a>3.2 åˆ—å­˜å‚¨æ•°æ®åº“</h4><ul>
<li><p>è¯´æ˜<br>è¿™éƒ¨åˆ†æ•°æ®åº“é€šå¸¸æ˜¯ç”¨æ¥åº”å¯¹åˆ†å¸ƒå¼å­˜å‚¨çš„<strong>æµ·é‡æ•°æ®</strong>ã€‚</p>
</li>
<li><p>ç‰¹ç‚¹<br>é”®ä»ç„¶å­˜åœ¨ï¼Œä½†æ˜¯å®ƒä»¬çš„ç‰¹ç‚¹æ˜¯æŒ‡å‘äº†å¤šä¸ªåˆ—ã€‚è¿™äº›åˆ—æ˜¯ç”±åˆ—å®¶æ—æ¥å®‰æ’çš„ã€‚</p>
</li>
<li><p>ç›¸å…³äº§å“<br>Cassandraã€<strong>HBase</strong>ã€Riakã€‚</p>
</li>
</ul>
<h4 id="3-3-æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆDocumentï¼‰"><a href="#3-3-æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆDocumentï¼‰" class="headerlink" title="3.3 æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆDocumentï¼‰"></a>3.3 æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆDocumentï¼‰</h4><ul>
<li><p>è¯´æ˜<br>æ–‡æ¡£å‹æ•°æ®åº“çš„çµæ„Ÿæ˜¯æ¥è‡ªäºLotus NotesåŠå…¬è½¯ä»¶çš„ï¼Œè€Œä¸”å®ƒåŒç¬¬ä¸€ç§é”®å€¼å­˜å‚¨ç›¸ç±»ä¼¼ï¼Œè¯¥ç±»å‹çš„æ•°æ®æ¨¡å‹æ˜¯ç‰ˆæœ¬åŒ–çš„æ–‡æ¡£ï¼ŒåŠç»“æ„åŒ–çš„æ–‡æ¡£ä»¥ç‰¹å®šçš„æ ¼å¼å­˜å‚¨ï¼Œæ¯”å¦‚<strong>JSON</strong>ã€‚æ–‡æ¡£å‹æ•°æ®åº“å¯ä»¥çœ‹ä½œæ˜¯é”®å€¼æ•°æ®åº“çš„å‡çº§ç‰ˆï¼Œå…è®¸ä¹‹é—´åµŒå¥—é”®å€¼ã€‚è€Œä¸”æ–‡æ¡£å‹æ•°æ®åº“æ¯”é”®å€¼æ•°æ®åº“çš„æŸ¥è¯¢æ•ˆç‡æ›´é«˜<br><code>&#123;&quot;name&quot;:&quot;wtt&quot;,&quot;age&quot;:&quot;23&quot;&#125; -----&gt; document</code></p>
</li>
<li><p>ç‰¹ç‚¹<br>ä»¥æ–‡æ¡£ï¼ˆjsonï¼‰å½¢å¼å­˜å‚¨</p>
</li>
<li><p>ç›¸å…³äº§å“<br><strong>MongoDBï¼ˆæœ€æ–°ç‰ˆä¸º6.xï¼Œæˆªè‡³2022.9.14ï¼‰</strong>ã€CouchDBï¼Œå›½å†…ä¹Ÿæœ‰æ–‡æ¡£å‹æ•°æ®åº“SequoiaDBï¼Œå·²ç»å¼€æºã€‚</p>
</li>
</ul>
<h4 id="3-4-å›¾å½¢-Graph-æ•°æ®åº“"><a href="#3-4-å›¾å½¢-Graph-æ•°æ®åº“" class="headerlink" title="3.4 å›¾å½¢(Graph)æ•°æ®åº“"></a>3.4 å›¾å½¢(Graph)æ•°æ®åº“</h4><ul>
<li><p>è¯´æ˜<br>å›¾å½¢ç»“æ„çš„æ•°æ®åº“åŒå…¶ä»–è¡Œåˆ—ä»¥åŠåˆšæ€§ç»“æ„çš„SQLæ•°æ®åº“ä¸åŒï¼Œå®ƒæ˜¯ä½¿ç”¨çµæ´»çš„å›¾å½¢æ¨¡å‹ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ‰©å±•åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šã€‚</p>
</li>
<li><p>ç‰¹ç‚¹<br>NoSQLæ•°æ®åº“æ²¡æœ‰æ ‡å‡†çš„æŸ¥è¯¢è¯­è¨€(SQL)ï¼Œå› æ­¤è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢éœ€è¦åˆ¶å®šæ•°æ®æ¨¡å‹ã€‚è®¸å¤šNoSQLæ•°æ®åº“éƒ½æœ‰RESTå¼çš„æ•°æ®æ¥å£æˆ–è€…æŸ¥è¯¢APIã€‚</p>
</li>
<li><p>ç›¸å…³äº§å“<br>Neo4Jã€InfoGridã€ Infinite Graphã€</p>
</li>
</ul>
<h2 id="4ã€NoSQLåº”ç”¨åœºæ™¯"><a href="#4ã€NoSQLåº”ç”¨åœºæ™¯" class="headerlink" title="4ã€NoSQLåº”ç”¨åœºæ™¯"></a>4ã€NoSQLåº”ç”¨åœºæ™¯</h2><ul>
<li><p><strong>æ•°æ®æ¨¡å‹æ¯”è¾ƒç®€å•</strong></p>
</li>
<li><p><strong>éœ€è¦çµæ´»æ€§æ›´å¼ºçš„ITç³»ç»Ÿï¼ˆç³»ç»Ÿè®¾è®¡çµæ´»ï¼Œæ€§èƒ½è¦æ±‚é«˜ï¼‰</strong></p>
</li>
<li><p><strong>å¯¹æ•°æ®åº“æ€§èƒ½è¦æ±‚è¾ƒé«˜</strong></p>
</li>
<li><p><strong>ä¸éœ€è¦é«˜åº¦çš„æ•°æ®ä¸€è‡´æ€§ (NoSQLäº§å“å¯¹äºäº‹åŠ¡æ”¯æŒä¸æ˜¯å¾ˆå¥½)</strong></p>
</li>
</ul>
<h2 id="5ã€ä»€ä¹ˆæ˜¯Redis"><a href="#5ã€ä»€ä¹ˆæ˜¯Redis" class="headerlink" title="5ã€ä»€ä¹ˆæ˜¯Redis"></a>5ã€ä»€ä¹ˆæ˜¯Redis</h2><p><img src="/Resources/Pasted%20image%2020220914160123.png" srcset="/img/loading.gif" lazyload></p>
<p>Redis ï¼ˆ<strong>Re</strong>mote <strong>Di</strong>ctionary <strong>S</strong>erverï¼‰ï¼Œè¿œç¨‹å­—å…¸æœåŠ¡</p>
<blockquote>
<p>The open source, in-memory data store used by millions of developers as a database, cache, streaming engine, and message broker.<br>æ•°ç™¾ä¸‡å¼€å‘äººå‘˜ä½¿ç”¨çš„å¼€æºå†…å­˜æ•°æ®å­˜å‚¨ä½œä¸º<strong>æ•°æ®åº“ã€ç¼“å­˜ã€æµå¼•æ“å’Œæ¶ˆæ¯ä¸­é—´ä»¶</strong>ã€‚</p>
</blockquote>
<p>Qï¼š<u>Redisä½¿ç”¨å†…å­˜ä½œä¸ºæ•°æ®åº“ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæ–­ç”µæ•°æ®ä¸ä¼šæ¶ˆå¤±å‘¢ï¼Ÿ</u><br>Aï¼š<u>æŒä¹…åŒ–æœºåˆ¶ï¼Œå®šæœŸå°†å†…å­˜æ•°æ®å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚</u></p>
<h2 id="6ã€Redisç‰¹ç‚¹"><a href="#6ã€Redisç‰¹ç‚¹" class="headerlink" title="6ã€Redisç‰¹ç‚¹"></a>6ã€Redisç‰¹ç‚¹</h2><ul>
<li><strong>Redisæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½key&#x2F;valueå†…å­˜å‹æ•°æ®åº“</strong></li>
<li><strong>Redisæ”¯æŒä¸°å¯Œçš„æ•°æ®ç±»å‹</strong></li>
<li><strong>Redisæ”¯æŒæŒä¹…åŒ–</strong></li>
<li><strong>Rediså•çº¿ç¨‹ï¼Œå•è¿›ç¨‹</strong>ï¼š6.0ä¹‹å‰ï¼šå‘½ä»¤å•çº¿ç¨‹ï¼Œç½‘ç»œå•çº¿ç¨‹ï¼Œ6.0ä¹‹åå‘½ä»¤å•çº¿ç¨‹ï¼Œç½‘ç»œå¤šçº¿ç¨‹ï¼Œ<a target="_blank" rel="noopener" href="https://blog.csdn.net/CSDN2497242041/article/details/122659705">Redis 6.0å¤šçº¿ç¨‹æ¨¡å‹æ€»ç»“</a><ul>
<li>å‘½ä»¤åŸºäºå†…å­˜æ“ä½œï¼Œå·²ç»å¾ˆå¿«äº†ï¼Œä¸éœ€è¦å¤šçº¿ç¨‹ï¼Œå¦‚æœä½¿ç”¨å¤šçº¿ç¨‹ï¼Œåè€Œä¼šå¼•èµ·ä¸€äº›é—®é¢˜ã€‚</li>
<li>ç½‘ç»œå¤šçº¿ç¨‹ï¼šå› ä¸ºè¯»å†™ç½‘ç»œçš„read&#x2F;writeç³»ç»Ÿè°ƒç”¨å ç”¨äº†Redisæ‰§è¡ŒæœŸé—´å¤§éƒ¨åˆ†CPUæ—¶é—´ï¼Œç“¶é¢ˆä¸»è¦åœ¨äºç½‘ç»œçš„ IO æ¶ˆè€—</li>
<li>ç½‘ç»œå¤šçº¿ç¨‹çš„å®ç°æ–¹å¼ï¼šIOå¤šè·¯å¤ç”¨+å¤šä¸ªäº‹ä»¶å¤„ç†å™¨</li>
<li><img src="/Resources/Pasted%20image%2020230606160933.png" srcset="/img/loading.gif" lazyload></li>
</ul>
</li>
</ul>
<h2 id="7ã€å®‰è£…Redis"><a href="#7ã€å®‰è£…Redis" class="headerlink" title="7ã€å®‰è£…Redis"></a>7ã€å®‰è£…Redis</h2><blockquote>
<p>å‚è€ƒåœ°å€ï¼š<a target="_blank" rel="noopener" href="https://redis.io/docs/getting-started/installation/">Installing Redis | Redis</a><br>åœ¨CentOsä¸­ä½¿ç”¨Dockerå®‰è£…Rediså‚è€ƒï¼š<a href="../../../Develop/%E5%BC%80%E5%8F%91%E8%99%9A%E6%8B%9F%E6%9C%BA/Docker%20%E5%AE%89%E8%A3%85%E5%AE%B9%E5%99%A8%E5%90%88%E9%9B%86.md#Redis">CentOsä¸­ä½¿ç”¨Dockerå®‰è£…Redis</a><br>ä»¥ä¸‹ä»…æ¼”ç¤ºåœ¨MacOSä¸­å®‰è£…Redis</p>
</blockquote>
<h2 id="8ã€Redisæ•°æ®åº“ç›¸å…³æŒ‡ä»¤"><a href="#8ã€Redisæ•°æ®åº“ç›¸å…³æŒ‡ä»¤" class="headerlink" title="8ã€Redisæ•°æ®åº“ç›¸å…³æŒ‡ä»¤"></a>8ã€Redisæ•°æ®åº“ç›¸å…³æŒ‡ä»¤</h2><blockquote>
<p>Rediså…¨éƒ¨å‘½ä»¤å‚è€ƒ<br>è‹±æ–‡å®˜ç½‘ï¼š<a target="_blank" rel="noopener" href="https://redis.io/commands/">Commands | Redis</a><br>ä¸­æ–‡ç½‘ï¼š<a target="_blank" rel="noopener" href="http://www.redis.cn/commands.html">Rediså‘½ä»¤ä¸­å¿ƒï¼ˆRedis commandsï¼‰</a></p>
</blockquote>
<h3 id="æ•°æ®åº“ç›¸å…³æŒ‡ä»¤"><a href="#æ•°æ®åº“ç›¸å…³æŒ‡ä»¤" class="headerlink" title="æ•°æ®åº“ç›¸å…³æŒ‡ä»¤"></a>æ•°æ®åº“ç›¸å…³æŒ‡ä»¤</h3><h4 id="Select-åˆ‡æ¢æ•°æ®åº“"><a href="#Select-åˆ‡æ¢æ•°æ®åº“" class="headerlink" title="Select åˆ‡æ¢æ•°æ®åº“"></a>Select åˆ‡æ¢æ•°æ®åº“</h4><p>Redisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ç¬¬0ä¸ªæ•°æ®åº“ </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379[3]&gt; <span class="hljs-keyword">select</span> 0<br>OK<br>127.0.0.1:6379&gt; <span class="hljs-comment">#é»˜è®¤æ•°æ®åº“åé¢æ²¡æœ‰&#x27;[ç¼–å·]&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379&gt; <span class="hljs-keyword">select</span> 3 <span class="hljs-comment">#åˆ‡æ¢æ•°æ®åº“</span><br>OK<br></code></pre></td></tr></table></figure>

<h4 id="Flushdb-è¯·ç©ºå½“å‰åº“"><a href="#Flushdb-è¯·ç©ºå½“å‰åº“" class="headerlink" title="Flushdb è¯·ç©ºå½“å‰åº“"></a>Flushdb è¯·ç©ºå½“å‰åº“</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379[3]&gt; flushdb<br>OK<br>127.0.0.1:6379[3]&gt; keys *<br>(empty array)<br></code></pre></td></tr></table></figure>

<h4 id="Flushall-è¯·ç©ºæ‰€æœ‰åº“"><a href="#Flushall-è¯·ç©ºæ‰€æœ‰åº“" class="headerlink" title="Flushall è¯·ç©ºæ‰€æœ‰åº“"></a>Flushall è¯·ç©ºæ‰€æœ‰åº“</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379[3]&gt; <span class="hljs-built_in">set</span> name <span class="hljs-string">&quot;wtt&quot;</span> <span class="hljs-comment">#åœ¨æ•°æ®åº“3ä¸­æ–°å¢æ•°æ®</span><br>OK<br>127.0.0.1:6379[3]&gt; get name<br><span class="hljs-string">&quot;wtt&quot;</span><br>127.0.0.1:6379[3]&gt; <span class="hljs-keyword">select</span> 7 <span class="hljs-comment">#åˆ‡æ¢åˆ°æ•°æ®åº“7</span><br>OK<br>127.0.0.1:6379[7]&gt; flushall <span class="hljs-comment">#åœ¨æ•°æ®åº“7æ¸…ç©ºæ‰€æœ‰åº“</span><br>OK<br>127.0.0.1:6379[7]&gt; <span class="hljs-keyword">select</span> 3<br>OK<br>127.0.0.1:6379[3]&gt; get name<br>(nil)<br></code></pre></td></tr></table></figure>

<h3 id="keyç›¸å…³æŒ‡ä»¤"><a href="#keyç›¸å…³æŒ‡ä»¤" class="headerlink" title="keyç›¸å…³æŒ‡ä»¤"></a>keyç›¸å…³æŒ‡ä»¤</h3><h4 id="Del-åˆ é™¤key"><a href="#Del-åˆ é™¤key" class="headerlink" title="Del åˆ é™¤key"></a>Del åˆ é™¤key</h4><blockquote>
<p>åŒæ—¶åˆ é™¤å¤šä¸ªkeyï¼šDEL key1 key2</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379&gt; get a<br><span class="hljs-string">&quot;v&quot;</span><br>127.0.0.1:6379&gt; del a<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; get a<br>(nil)<br></code></pre></td></tr></table></figure>

<h4 id="Exists-åˆ¤æ–­é”®å€¼æ˜¯å¦å­˜åœ¨"><a href="#Exists-åˆ¤æ–­é”®å€¼æ˜¯å¦å­˜åœ¨" class="headerlink" title="Exists åˆ¤æ–­é”®å€¼æ˜¯å¦å­˜åœ¨"></a>Exists åˆ¤æ–­é”®å€¼æ˜¯å¦å­˜åœ¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379&gt; exists name<br>(<span class="hljs-built_in">integer</span>) 1 <span class="hljs-comment"># 1 = å­˜åœ¨ ï¼Œ0 = ä¸å­˜åœ¨</span><br></code></pre></td></tr></table></figure>

<h4 id="Ttl-è¿”å›å½“å‰keyçš„è¿‡æœŸæ—¶é—´-è¿‡æœŸæ—¶é—´ä¸ºç§’"><a href="#Ttl-è¿”å›å½“å‰keyçš„è¿‡æœŸæ—¶é—´-è¿‡æœŸæ—¶é—´ä¸ºç§’" class="headerlink" title="Ttl è¿”å›å½“å‰keyçš„è¿‡æœŸæ—¶é—´ è¿‡æœŸæ—¶é—´ä¸ºç§’"></a>Ttl è¿”å›å½“å‰keyçš„è¿‡æœŸæ—¶é—´ <em>è¿‡æœŸæ—¶é—´ä¸ºç§’</em></h4><blockquote>
<p>å½“keyä¸å­˜åœ¨æ—¶ï¼Œè¿”å›-2ã€‚<br>å½“keyå­˜åœ¨ä½†æ²¡æœ‰è®¾ç½®å‰©ä½™ç”Ÿå­˜æ—¶é—´æ—¶ï¼Œè¿”å›-1ã€‚<br>å¦åˆ™ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œè¿”å›keyçš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379[1]&gt; expire name 10<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379[1]&gt; ttl name <span class="hljs-comment">#ttl æŸ¥çœ‹å‰©ä½™æ—¶é—´</span><br>(<span class="hljs-built_in">integer</span>) 0<br>127.0.0.1:6379[1]&gt; get name<br>(nil)<br></code></pre></td></tr></table></figure>

<h4 id="Pttl-è¿”å›å½“å‰keyçš„è¿‡æœŸæ—¶é—´-è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’"><a href="#Pttl-è¿”å›å½“å‰keyçš„è¿‡æœŸæ—¶é—´-è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’" class="headerlink" title="Pttl è¿”å›å½“å‰keyçš„è¿‡æœŸæ—¶é—´ è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’"></a>Pttl è¿”å›å½“å‰keyçš„è¿‡æœŸæ—¶é—´ <em>è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’</em></h4><h4 id="Expire-è®¾ç½®å½“å‰keyçš„è¿‡æœŸæ—¶é—´-è¿‡æœŸæ—¶é—´ä¸ºç§’"><a href="#Expire-è®¾ç½®å½“å‰keyçš„è¿‡æœŸæ—¶é—´-è¿‡æœŸæ—¶é—´ä¸ºç§’" class="headerlink" title="Expire è®¾ç½®å½“å‰keyçš„è¿‡æœŸæ—¶é—´ è¿‡æœŸæ—¶é—´ä¸ºç§’"></a>Expire è®¾ç½®å½“å‰keyçš„è¿‡æœŸæ—¶é—´ <em>è¿‡æœŸæ—¶é—´ä¸ºç§’</em></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379[1]&gt; expire name 10<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379[1]&gt; ttl name <span class="hljs-comment">#ttl æŸ¥çœ‹å‰©ä½™æ—¶é—´</span><br>(<span class="hljs-built_in">integer</span>) 0<br>127.0.0.1:6379[1]&gt; get name<br>(nil)<br></code></pre></td></tr></table></figure>

<h4 id="Pexpire-è®¾ç½®å½“å‰keyçš„è¿‡æœŸæ—¶é—´-è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’"><a href="#Pexpire-è®¾ç½®å½“å‰keyçš„è¿‡æœŸæ—¶é—´-è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’" class="headerlink" title="Pexpire è®¾ç½®å½“å‰keyçš„è¿‡æœŸæ—¶é—´ è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’"></a>Pexpire è®¾ç½®å½“å‰keyçš„è¿‡æœŸæ—¶é—´ <em>è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’</em></h4><h4 id="Keys-æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼çš„key"><a href="#Keys-æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼çš„key" class="headerlink" title="Keys æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼çš„key"></a>Keys æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼çš„key</h4><blockquote>
<p>*å¤šä¸ªï¼Œ?å•ä¸ªï¼Œ[abc]å…¶ä¸€ï¼Œç±»ä¼¼äºæ­£åˆ™è¡¨è¾¾å¼</p>
</blockquote>
<ul>
<li>keys* æŸ¥æ‰¾æ‰€æœ‰key</li>
<li>keys h?llo æŸ¥æ‰¾hello,hallo,hxlloç­‰</li>
<li>keys h*llo æŸ¥æ‰¾hllo,heeeelloç­‰</li>
<li>Keys h[ae]lloåŒ¹é…helloå’Œhallo ,ä½†ä¸åŒ¹é…hilloã€‚ç‰¹æ®Šç¬¦å·ç”¨â€\â€œéš”å¼€<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">6379</span>[<span class="hljs-number">3</span>]&gt; keys *<br><span class="hljs-attribute">1</span>) <span class="hljs-string">&quot;name&quot;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="Move-ç§»åŠ¨é”®å€¼åˆ°å¦å¤–ä¸€ä¸ªæ•°æ®åº“"><a href="#Move-ç§»åŠ¨é”®å€¼åˆ°å¦å¤–ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="Move ç§»åŠ¨é”®å€¼åˆ°å¦å¤–ä¸€ä¸ªæ•°æ®åº“"></a>Move ç§»åŠ¨é”®å€¼åˆ°å¦å¤–ä¸€ä¸ªæ•°æ®åº“</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379&gt; get name<br><span class="hljs-string">&quot;xr&quot;</span><br>127.0.0.1:6379&gt; move name 1<br>(<span class="hljs-built_in">integer</span>) 1<br>127.0.0.1:6379&gt; <span class="hljs-keyword">select</span> 1<br>OK<br>127.0.0.1:6379[1]&gt; get name<br><span class="hljs-string">&quot;xr&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="Rename-ä¿®æ”¹å½“å‰keyçš„åå­—"><a href="#Rename-ä¿®æ”¹å½“å‰keyçš„åå­—" class="headerlink" title="Rename ä¿®æ”¹å½“å‰keyçš„åå­—"></a>Rename ä¿®æ”¹å½“å‰keyçš„åå­—</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379&gt; <span class="hljs-built_in">set</span> a b<br>OK<br>127.0.0.1:6379&gt; rename a aa<br>OK<br>127.0.0.1:6379&gt; get aa<br><span class="hljs-string">&quot;b&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="Type-æŸ¥çœ‹å½“å‰keyçš„ç±»å‹"><a href="#Type-æŸ¥çœ‹å½“å‰keyçš„ç±»å‹" class="headerlink" title="Type æŸ¥çœ‹å½“å‰keyçš„ç±»å‹"></a>Type æŸ¥çœ‹å½“å‰keyçš„ç±»å‹</h4><ul>
<li>none (keyä¸å­˜åœ¨)</li>
<li>string (å­—ç¬¦ä¸²)</li>
<li>list (åˆ—è¡¨)</li>
<li>set (é›†åˆ)</li>
<li>Zset (æœ‰åºé›†)</li>
<li>hash (å“ˆå¸Œè¡¨)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379[1]&gt; <span class="hljs-built_in">type</span> name<br>string<br></code></pre></td></tr></table></figure>

<h4 id="Dbsize-æŸ¥çœ‹é”®æ€»æ•°"><a href="#Dbsize-æŸ¥çœ‹é”®æ€»æ•°" class="headerlink" title="Dbsize æŸ¥çœ‹é”®æ€»æ•°"></a>Dbsize æŸ¥çœ‹é”®æ€»æ•°</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1:6379[3]&gt; dbsize <span class="hljs-comment">#æŸ¥çœ‹æ•°æ®åº“å¤§å°</span><br>(<span class="hljs-built_in">integer</span>) 0<br></code></pre></td></tr></table></figure>


<h3 id="äº”å¤§æ•°æ®ç±»å‹"><a href="#äº”å¤§æ•°æ®ç±»å‹" class="headerlink" title="äº”å¤§æ•°æ®ç±»å‹"></a>äº”å¤§æ•°æ®ç±»å‹</h3><p><strong>æ•°æ®ç±»å‹</strong>ï¼šæŒ‡çš„æ˜¯å­˜å‚¨çš„æ•°æ®çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ value éƒ¨åˆ†çš„ç±»å‹ï¼Œ key éƒ¨åˆ†æ°¸è¿œéƒ½æ˜¯å­—ç¬¦ä¸²ã€‚</p>
<p><strong>Redis æ•°æ®å­˜å‚¨æ ¼å¼</strong>ï¼šRedisè‡ªèº«æ˜¯ä¸€ä¸ª Mapï¼Œå…¶ä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯é‡‡ç”¨ key : valueçš„å½¢å¼å­˜å‚¨ã€‚</p>
<h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4><p><code>Map&lt;String,String&gt; map</code><br><img src="/Resources/Pasted%20image%2020220915104123.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>å¸¸ç”¨æ“ä½œå‘½ä»¤</strong></p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
<th>èŒƒä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>set</td>
<td>è®¾ç½®ä¸€ä¸ªkey&#x2F;value</td>
<td><code>set k1 v1</code></td>
</tr>
<tr>
<td>get</td>
<td>æ ¹æ®keyè·å¾—å¯¹åº”çš„value</td>
<td><code>get k1</code></td>
</tr>
<tr>
<td>mset</td>
<td>ä¸€æ¬¡è®¾ç½®å¤šä¸ªkey&#x2F;value</td>
<td><code>mset k1 v1 k2 v2</code></td>
</tr>
<tr>
<td>mget</td>
<td>ä¸€æ¬¡è·å–å¤šä¸ªkey&#x2F;value</td>
<td><code>mget k1 k2</code></td>
</tr>
<tr>
<td>strlen</td>
<td>è·å–å¯¹åº”keyçš„valueçš„é•¿åº¦</td>
<td><code>strlen k1</code></td>
</tr>
<tr>
<td>append</td>
<td>ä¸ºå¯¹åº”çš„keyçš„valueè¿½åŠ å†…å®¹ï¼ˆå¦‚æœä¸å­˜åœ¨keyï¼Œé‚£ä¹ˆå°±è‡ªåŠ¨åˆ›å»ºkeyï¼‰</td>
<td><code>append key1 &quot;this is append value&quot;</code></td>
</tr>
<tr>
<td>getrangeï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰</td>
<td>æˆªå–valueçš„å†…å®¹ï¼ˆ0åˆ°-1ä»£è¡¨æ‰€æœ‰å†…å®¹ï¼‰</td>
<td><code>getrange key1 0 -1</code></td>
</tr>
<tr>
<td>setex</td>
<td>è®¾ç½®ä¸€ä¸ªkeyå­˜æ´»çš„æœ‰æ•ˆæœŸ <strong>ç§’</strong></td>
<td><code>setex key1 30 &quot;hello&quot;</code></td>
</tr>
<tr>
<td>psetex</td>
<td>è®¾ç½®ä¸€ä¸ªkeyå­˜æ´»çš„æœ‰æ•ˆæœŸ <strong>æ¯«ç§’</strong></td>
<td><code>psetex key1 30 &quot;hello&quot;</code></td>
</tr>
<tr>
<td>setnx</td>
<td>å­˜åœ¨ä¸åšä»»ä½•æ“ä½œï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ </td>
<td><code> setnx key1 wtt</code></td>
</tr>
<tr>
<td>msetnxåŸå­æ“ä½œï¼ˆåªè¦æœ‰ä¸€ä¸ªå­˜åœ¨å°±ä¸åšä»»ä½•æ“ä½œï¼‰</td>
<td>åŒæ—¶è®¾ç½®å¤šä¸ªkeyï¼Œåªæœ‰éƒ½ä¸å­˜åœ¨æ—¶æ‰ä¿å­˜</td>
<td></td>
</tr>
<tr>
<td>decr</td>
<td>è¿›è¡Œæ•°å€¼ç±»å‹çš„-1æ“ä½œ</td>
<td><code>decr key1</code></td>
</tr>
<tr>
<td>decrby</td>
<td>æ ¹æ®æä¾›çš„æ•°æ®è¿›è¡Œå‡æ³•æ“ä½œ</td>
<td><code>decrby key1 5</code></td>
</tr>
<tr>
<td>incr</td>
<td>è¿›è¡Œæ•°å€¼ç±»å‹çš„+1æ“ä½œ</td>
<td><code>incr key1</code></td>
</tr>
<tr>
<td>incrby</td>
<td>æ ¹æ®æä¾›çš„æ•°æ®è¿›è¡ŒåŠ æ³•æ“ä½œ</td>
<td><code>incrby key1 5</code></td>
</tr>
<tr>
<td>incrbyfloat</td>
<td>æ ¹æ®æä¾›çš„æ•°æ®åŠ æµ®ç‚¹æ•°</td>
<td><code>incrbyfloat key1 1.5</code></td>
</tr>
</tbody></table>
<h4 id="List"><a href="#List" class="headerlink" title="List"></a>List</h4><p><code>Map&lt;String,List&gt; map</code></p>
<blockquote>
<p>åŒºåˆ«äºJavaä¸­çš„Listï¼ŒRedisä¸­çš„Listå¯ä»¥é€šè¿‡lpushä»å·¦å‘åˆ—è¡¨æ”¾å…¥å…ƒç´ ï¼Œä¹Ÿå¯ä»¥é€šè¿‡rpushä»å³å‘åˆ—è¡¨æ”¾å…¥å…ƒç´ ï¼ˆæœ¬è´¨æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼‰ï¼</p>
</blockquote>
<p><img src="/Resources/Pasted%20image%2020220915104344.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>å¸¸ç”¨æ“ä½œå‘½ä»¤</strong></p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
<th>èŒƒä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>lpush</td>
<td>å°†æŸä¸ªå€¼æˆ–å¤šä¸ªå€¼åŠ å…¥åˆ°ä¸€ä¸ªkeyåˆ—è¡¨å¤´éƒ¨</td>
<td><code>lpush list value1 value2</code></td>
</tr>
<tr>
<td>lpushx</td>
<td>åŒlpush,ä½†æ˜¯å¿…é¡»è¦ä¿è¯è¿™ä¸ªkeyå­˜åœ¨</td>
<td><code>xpushx list value3 value4</code></td>
</tr>
<tr>
<td>rpush</td>
<td>å°†æŸä¸ªå€¼æˆ–å¤šä¸ªå€¼åŠ å…¥åˆ°ä¸€ä¸ªkeyåˆ—è¡¨æœ«å°¾</td>
<td><code>rpush list value5</code></td>
</tr>
<tr>
<td>rpushx</td>
<td>åŒrpush,ä½†æ˜¯å¿…é¡»è¦ä¿è¯è¿™ä¸ªkeyå­˜åœ¨</td>
<td><code>rpush list value5</code></td>
</tr>
<tr>
<td>lpop</td>
<td>è¿”å›å’Œç§»é™¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ </td>
<td><code>lpop list</code> (ç§»é™¤å¤šä¸ªå…ƒç´ ä½¿ç”¨<code>lpop list n</code> nä»£è¡¨ç§»é™¤å‡ ä¸ª)</td>
</tr>
<tr>
<td>rpop</td>
<td>è¿”å›å’Œç§»é™¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ </td>
<td><code>lpop list</code> (ç§»é™¤å¤šä¸ªå…ƒç´ ä½¿ç”¨<code>lpop list n</code> nä»£è¡¨ç§»é™¤å‡ ä¸ª</td>
</tr>
<tr>
<td>lrange 0 -1</td>
<td>è·å–æŸä¸€ä¸ªä¸‹æ ‡åŒºé—´å†…çš„å…ƒç´ </td>
<td><code>lrange list 0 -1</code></td>
</tr>
<tr>
<td>llen</td>
<td>è·å–åˆ—è¡¨å…ƒç´ ä¸ªæ•°</td>
<td><code>llen list</code></td>
</tr>
<tr>
<td>lset</td>
<td>è®¾ç½®æŸä¸€ä¸ªæŒ‡å®šç´¢å¼•çš„å€¼(ç´¢å¼•å¿…é¡»å­˜åœ¨)</td>
<td><code>lset list 0 value</code></td>
</tr>
<tr>
<td>lindex</td>
<td>è·å–æŸä¸€ä¸ªæŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </td>
<td><code>lindex list 0</code></td>
</tr>
<tr>
<td>lrem</td>
<td>åˆ é™¤é‡å¤å…ƒç´ </td>
<td><code>lrem list 2 value</code> (æ•°å­—ä»£è¡¨ç§»é™¤å‡ ä¸ªé‡å¤çš„å€¼)</td>
</tr>
<tr>
<td>ltrim</td>
<td>ä¿ç•™åˆ—è¡¨ä¸­ç‰¹å®šåŒºé—´å†…çš„å…ƒç´ </td>
<td><code>ltrim list 1 2</code></td>
</tr>
<tr>
<td>linsert</td>
<td>åœ¨æŸä¸€ä¸ªå…ƒç´ ä¹‹å‰(before)æˆ–è€…ä¹‹å(after)æ’å…¥æ–°å…ƒç´ </td>
<td><code>linsert list before value3 value</code></td>
</tr>
</tbody></table>
<h4 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h4><p><code>Map&lt;String,Set&gt; map</code><br><img src="/Resources/Pasted%20image%2020220915150230.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>å¸¸ç”¨æ“ä½œå‘½ä»¤</strong></p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
<th>èŒƒä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>sadd</td>
<td>ä¸ºé›†åˆæ·»åŠ å…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>smembers</td>
<td>æ˜¾ç¤ºé›†åˆä¸­æ‰€æœ‰å…ƒç´ æ— åº</td>
<td></td>
</tr>
<tr>
<td>scard</td>
<td>è¿”å›é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°</td>
<td></td>
</tr>
<tr>
<td>spop</td>
<td>éšæœºè¿”å›ä¸€ä¸ªå…ƒç´ å¹¶å°†å…ƒç´ åœ¨é›†åˆä¸­åˆ é™¤</td>
<td></td>
</tr>
<tr>
<td>smove</td>
<td>ä»ä¸€ä¸ªé›†åˆä¸­å‘å¦ä¸€ä¸ªé›†åˆç§»åŠ¨å…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>srem</td>
<td>ä»é›†åˆä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>sismember</td>
<td>åˆ¤æ–­ä¸€ä¸ªé›†åˆä¸­æ˜¯å¦å«æœ‰è¿™ä¸ªå…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>srandmember</td>
<td>éšæœºè¿”å›å…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>sdiff</td>
<td>å»æ‰ç¬¬ä¸€ä¸ªé›†åˆä¸­å…¶å®ƒé›†åˆå«æœ‰çš„ç›¸åŒå…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>sinter</td>
<td>æ±‚äº¤é›†</td>
<td></td>
</tr>
<tr>
<td>sunion</td>
<td>æ±‚å’Œé›†</td>
<td></td>
</tr>
</tbody></table>
<h4 id="Zset"><a href="#Zset" class="headerlink" title="Zset"></a>Zset</h4><p><code>Map&lt;String,ZSet&gt; map</code></p>
<blockquote>
<p>åŒºåˆ«äºSetï¼ŒZsetæ˜¯æœ‰åºçš„ã€‚</p>
</blockquote>
<p><img src="/Resources/Pasted%20image%2020220915150705.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>å¸¸ç”¨æ“ä½œå‘½ä»¤</strong></p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
<th>èŒƒä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>zadd</td>
<td>æ·»åŠ ä¸€ä¸ªæœ‰åºé›†åˆå…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>zcard</td>
<td>è¿”å›é›†åˆçš„å…ƒç´ ä¸ªæ•°</td>
<td></td>
</tr>
<tr>
<td>zrangeå‡åº zrevrangeé™åº</td>
<td>è¿”å›ä¸€ä¸ªèŒƒå›´å†…çš„å…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>zrangebyscore</td>
<td>æŒ‰ç…§åˆ†æ•°æŸ¥æ‰¾ä¸€ä¸ªèŒƒå›´å†…çš„å…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>zrank</td>
<td>è¿”å›æ’å</td>
<td></td>
</tr>
<tr>
<td>zrevrank</td>
<td>å€’åºæ’å</td>
<td></td>
</tr>
<tr>
<td>zscore</td>
<td>æ˜¾ç¤ºæŸä¸€ä¸ªå…ƒç´ çš„åˆ†æ•°</td>
<td></td>
</tr>
<tr>
<td>zrem</td>
<td>ç§»é™¤æŸä¸€ä¸ªå…ƒç´ </td>
<td></td>
</tr>
<tr>
<td>zincrby*</td>
<td>ç»™æŸä¸ªç‰¹å®šå…ƒç´ åŠ åˆ†</td>
<td></td>
</tr>
</tbody></table>
<h4 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h4><p><code>Map&lt;String,Map&lt;String,value&gt;&gt; map</code><br><img src="/Resources/Pasted%20image%2020220915151206.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>å¸¸ç”¨æ“ä½œå‘½ä»¤</strong></p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
<th>èŒƒä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>hset</td>
<td>è®¾ç½®ä¸€ä¸ªkey&#x2F;valueå¯¹</td>
<td></td>
</tr>
<tr>
<td>hget</td>
<td>è·å¾—ä¸€ä¸ªkeyå¯¹åº”çš„value</td>
<td></td>
</tr>
<tr>
<td>hgetall</td>
<td>è·å¾—æ‰€æœ‰çš„key&#x2F;valueå¯¹</td>
<td></td>
</tr>
<tr>
<td>hdel</td>
<td>åˆ é™¤æŸä¸€ä¸ªkey&#x2F;valueå¯¹</td>
<td></td>
</tr>
<tr>
<td>hexists</td>
<td>åˆ¤æ–­ä¸€ä¸ªkeyæ˜¯å¦å­˜åœ¨</td>
<td></td>
</tr>
<tr>
<td>hkeys</td>
<td>è·å¾—æ‰€æœ‰çš„key</td>
<td></td>
</tr>
<tr>
<td>hvals</td>
<td>è·å¾—æ‰€æœ‰çš„value</td>
<td></td>
</tr>
<tr>
<td>hmsetè®¾ç½®å¤šä¸ªkey&#x2F;value</td>
<td></td>
<td></td>
</tr>
<tr>
<td>hmget</td>
<td>è·å¾—å¤šä¸ªkeyçš„value</td>
<td></td>
</tr>
<tr>
<td>hsetnxè®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨çš„keyçš„å€¼</td>
<td></td>
<td></td>
</tr>
<tr>
<td>hincrbyä¸ºvalueè¿›è¡ŒåŠ æ³•è¿ç®—</td>
<td></td>
<td></td>
</tr>
<tr>
<td>hincrbyfloat</td>
<td>ä¸ºvalueåŠ å…¥æµ®ç‚¹å€¼</td>
<td></td>
</tr>
</tbody></table>
<h2 id="9ã€Redisçš„æŒä¹…åŒ–æœºåˆ¶"><a href="#9ã€Redisçš„æŒä¹…åŒ–æœºåˆ¶" class="headerlink" title="9ã€Redisçš„æŒä¹…åŒ–æœºåˆ¶"></a>9ã€Redisçš„æŒä¹…åŒ–æœºåˆ¶</h2><blockquote>
<p>å‚è€ƒæ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://redis.io/docs/manual/persistence/">Redis persistence | Redis</a></p>
</blockquote>
<p>Rediså®˜æ–¹æä¾›äº†ä¸¤ç§ä¸åŒçš„æŒä¹…åŒ–æ–¹æ³•æ¥å°†æ•°æ®å­˜å‚¨åˆ°ç¡¬ç›˜ï¼Œæ—¢å¯ä»¥åŒæ—¶ä½¿ç”¨(aof)ï¼Œåˆå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œåœ¨æŸç§æƒ…å†µä¸‹ä¹Ÿå¯ä»¥éƒ½ä¸ä½¿ç”¨ï¼Œå…·ä½“ä½¿ç”¨é‚£ç§æŒä¹…åŒ–æ–¹æ¡ˆå–å†³äºç”¨æˆ·çš„æ•°æ®å’Œåº”ç”¨å†³å®šã€‚</p>
<blockquote>
<p>æ— è®ºä½¿ç”¨AOFè¿˜æ˜¯å¿«ç…§æœºåˆ¶æŒä¹…åŒ–ï¼Œå°†æ•°æ®æŒä¹…åŒ–åˆ°ç¡¬ç›˜éƒ½æ˜¯æœ‰å¿…è¦çš„ï¼Œé™¤äº†æŒä¹…åŒ–å¤–ï¼Œç”¨æˆ·è¿˜åº”è¯¥å¯¹æŒä¹…åŒ–çš„æ–‡ä»¶è¿›è¡Œå¤‡ä»½(æœ€å¥½å¤‡ä»½åœ¨å¤šä¸ªä¸åŒåœ°æ–¹)ã€‚</p>
</blockquote>
<ul>
<li>ROB(Redis Database Backup file)ï¼šä¿å­˜è¿™ä¸€æ—¶åˆ»çš„æ•°æ®çŠ¶æ€ï¼Œä¹Ÿè¢«å«åšRedisæ•°æ®å¤‡ä»½æ–‡ä»¶</li>
<li>AOF(<strong>Append Only File</strong>)ï¼šå°†æ‰€æœ‰rediså†™å‘½ä»¤è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­</li>
<li><img src="/Resources/Pasted%20image%2020230531170507.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<h3 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h3><h4 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h4><p>è¿™ç§æ–¹å¼å¯ä»¥å°†æŸä¸€æ—¶åˆ»çš„æ‰€æœ‰æ•°æ®éƒ½å†™å…¥ç¡¬ç›˜ä¸­ï¼Œå½“ç„¶è¿™ä¹Ÿæ˜¯redisçš„<strong>é»˜è®¤æŒä¹…åŒ–æ–¹å¼</strong>ï¼Œä¿å­˜çš„æ–‡ä»¶æ˜¯ä»¥.rdbå½¢å¼ç»“å°¾çš„æ–‡ä»¶ï¼Œå› æ­¤è¿™ç§æ–¹å¼ä¹Ÿç§°ä¹‹ä¸ºRDBæ–¹å¼ã€‚<br><img src="/Resources/Pasted%20image%2020220915155813.png" srcset="/img/loading.gif" lazyload><br><img src="/Resources/Pasted%20image%2020220915160528.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="å¿«ç…§ç”Ÿæˆæ–¹å¼"><a href="#å¿«ç…§ç”Ÿæˆæ–¹å¼" class="headerlink" title="å¿«ç…§ç”Ÿæˆæ–¹å¼"></a>å¿«ç…§ç”Ÿæˆæ–¹å¼</h4><ul>
<li>å®¢æˆ·ç«¯æ–¹å¼ï¼šBGSAVEå’ŒSAVEæŒ‡ä»¤</li>
<li>æœåŠ¡å™¨é…ç½®è‡ªåŠ¨è§¦å‘</li>
</ul>
<h5 id="å®¢æˆ·ç«¯æ–¹å¼"><a href="#å®¢æˆ·ç«¯æ–¹å¼" class="headerlink" title="å®¢æˆ·ç«¯æ–¹å¼"></a>å®¢æˆ·ç«¯æ–¹å¼</h5><p><strong>BGSAVE</strong><br>å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨BGSAVEå‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼Œå½“æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„BGSAVEå‘½ä»¤æ—¶ï¼Œredisä¼šè°ƒç”¨forkæ¥åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶åå­è¿›ç¨‹è´Ÿè´£å°†å¿«ç…§å†™å…¥ç£ç›˜ä¸­ï¼Œè€Œçˆ¶è¿›ç¨‹åˆ™ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚<br>ç–‘é—®ï¼šå½“æ‰§è¡Œforkæ“ä½œæ—¶ï¼Œè¿›è¡Œäº†rediså†™æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™æ•°æ®æ‹·è´äº†ä¸€ä»½ï¼Œå¯¹æ•°æ®å‰¯æœ¬Bè¿›è¡Œäº†å†™æ“ä½œï¼Œé‚£ä¹ˆä¹‹åæ˜¯æ€ä¹ˆå¤„ç†çš„<br><img src="/Resources/Pasted%20image%2020230531164423.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>SAVE</strong><br>å®¢æˆ·ç«¯è¿˜å¯ä»¥ä½¿ç”¨SAVEå‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼Œæ¥æ”¶åˆ°SAVEå‘½ä»¤çš„redisæœåŠ¡å™¨åœ¨å¿«ç…§åˆ›å»ºå®Œæ¯•ä¹‹å‰å°†ä¸å†å“åº”ä»»ä½•å…¶ä»–çš„å‘½ä»¤<br><img src="/Resources/Pasted%20image%2020220915162455.png" srcset="/img/loading.gif" lazyload></p>
<p>ğŸ””<strong>æ³¨æ„ï¼šSAVEå‘½ä»¤å¹¶ä¸å¸¸ç”¨ï¼Œä½¿ç”¨SAVEå‘½ä»¤åœ¨å¿«ç…§åˆ›å»ºå®Œæ¯•ä¹‹å‰ï¼Œrediså¤„äºé˜»å¡çŠ¶æ€,æ— æ³•å¯¹å¤–æœåŠ¡ã€‚</strong></p>
<h5 id="æœåŠ¡å™¨é…ç½®è‡ªåŠ¨è§¦å‘"><a href="#æœåŠ¡å™¨é…ç½®è‡ªåŠ¨è§¦å‘" class="headerlink" title="æœåŠ¡å™¨é…ç½®è‡ªåŠ¨è§¦å‘"></a>æœåŠ¡å™¨é…ç½®è‡ªåŠ¨è§¦å‘</h5><p>å¦‚æœç”¨æˆ·åœ¨redis.confä¸­è®¾ç½®äº†saveé…ç½®é€‰é¡¹ï¼Œredisä¼šåœ¨saveé€‰é¡¹æ¡ä»¶æ»¡è¶³ä¹‹åè‡ªåŠ¨è§¦å‘ä¸€æ¬¡BGSAVEå‘½ä»¤ï¼Œå¦‚æœè®¾ç½®å¤šä¸ªsaveé…ç½®é€‰é¡¹ï¼Œå½“ä»»æ„ä¸€ä¸ªsaveé…ç½®é€‰é¡¹æ¡ä»¶æ»¡è¶³ï¼Œredisä¹Ÿä¼šè§¦å‘ä¸€æ¬¡BGSAVEå‘½ä»¤ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs conf"># æ³¨è¯¥é…ç½®æ–‡ä»¶æ˜¯redis7çš„<br>################################ SNAPSHOTTING  ################################<br><br># Save the DB to disk. å°†æ•°æ®åº“ä¿å­˜åˆ°ç£ç›˜.<br>#<br># save &lt;seconds&gt; &lt;changes&gt; [&lt;seconds&gt; &lt;changes&gt; ...]<br>#<br># Redis will save the DB if the given number of seconds elapsed and it<br># surpassed the given number of write operations against the DB.<br># å¦‚æœç»è¿‡äº†ç»™å®šçš„ç§’æ•°ï¼Œå¹¶ä¸”è¶…è¿‡äº†é’ˆå¯¹DBçš„ç»™å®šå†™å…¥æ“ä½œæ•°ï¼ŒRediså°†æ•°æ®åº“ä¿å­˜åˆ°ç£ç›˜.<br>#<br># Snapshotting can be completely disabled with a single empty string argument<br># as in following example:<br># ä½¿ç”¨ save &quot;&quot; å³å¯ç¦ç”¨redisä¸­çš„Snapshotting<br>#<br># save &quot;&quot;<br>#<br># Unless specified otherwise, by default Redis will save the DB:<br>#   * After 3600 seconds (an hour) if at least 1 change was performed<br>#   * After 300 seconds (5 minutes) if at least 100 changes were performed<br>#   * After 60 seconds if at least 10000 changes were performed<br># é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™é»˜è®¤æƒ…å†µä¸‹Redisä¼šä¿å­˜æ•°æ®åº“ï¼š<br>#   è¿™é‡Œçš„ç¿»è¯‘ä¸»è¦å‡ºè‡ªäº https://redis.io/docs/management/persistence/#snapshotting ä¸­å…³äºrdbçš„è§£é‡Š<br>#   You can configure Redis to have it save the dataset <br>#   every N seconds if there are at least M changes in the dataset  å¦‚æœæ¯nç§’å‘ç”Ÿäº†mæ¬¡<br>#   , or you can manually call the SAVE or BGSAVE commands.<br>#   æ¯3600ç§’ï¼Œ1æ¬¡æ›´æ”¹<br>#   æ¯300ç§’ï¼Œ100æ¬¡æ›´æ”¹<br>#   æ¯60ç§’åï¼Œ10000æ¬¡æ›´æ”¹<br># <br># You can set these explicitly by uncommenting the following line.<br># æ‚¨å¯ä»¥é€šè¿‡å–æ¶ˆå¯¹ä»¥ä¸‹è¡Œçš„æ³¨é‡Šæ¥æ˜¾å¼è®¾ç½®è¿™äº›å€¼ã€‚<br>#<br># save 3600 1 300 100 60 10000<br><br><br># æ³¨è¯¥é…ç½®æ–‡ä»¶æ˜¯redis6.2çš„ï¼ŒåŸºæœ¬ä¸Šè·Ÿ7å·®ä¸å¤šï¼Œå°±ä¸å†ç¿»è¯‘äº†<br>################################ SNAPSHOTTING  ################################<br><br># Save the DB to disk.<br>#<br># save &lt;seconds&gt; &lt;changes&gt;<br>#<br># Redis will save the DB if both the given number of seconds and the given<br># number of write operations against the DB occurred.<br>#<br># Snapshotting can be completely disabled with a single empty string argument<br># as in following example:<br>#<br># save &quot;&quot;<br>#<br># Unless specified otherwise, by default Redis will save the DB:<br>#   * After 3600 seconds (an hour) if at least 1 key changed<br>#   * After 300 seconds (5 minutes) if at least 100 keys changed<br>#   * After 60 seconds if at least 10000 keys changed<br>#<br># You can set these explicitly by uncommenting the three following lines.<br>#<br># save 3600 1<br># save 300 100<br># save 60 10000<br></code></pre></td></tr></table></figure>

<h5 id="æœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯shutdownæŒ‡ä»¤"><a href="#æœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯shutdownæŒ‡ä»¤" class="headerlink" title="æœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯shutdownæŒ‡ä»¤"></a>æœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯shutdownæŒ‡ä»¤</h5><p>å½“redisé€šè¿‡shutdownæŒ‡ä»¤æ¥æ”¶åˆ°å…³é—­æœåŠ¡å™¨çš„è¯·æ±‚æ—¶ï¼Œä¼šæ‰§è¡Œä¸€ä¸ªsaveå‘½ä»¤ï¼Œé˜»å¡æ‰€æœ‰çš„å®¢æˆ·ç«¯ï¼Œä¸å†æ‰§è¡Œå®¢æˆ·ç«¯æ‰§è¡Œå‘é€çš„ä»»ä½•å‘½ä»¤ï¼Œå¹¶ä¸”åœ¨saveå‘½ä»¤æ‰§è¡Œå®Œæ¯•ä¹‹åå…³é—­æœåŠ¡å™¨ã€‚</p>
<h3 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h3><h4 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h4><p>è¿™ç§æ–¹å¼å¯ä»¥å°†æ‰€æœ‰å®¢æˆ·ç«¯æ‰§è¡Œçš„å†™å‘½ä»¤è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼ŒAOFæŒä¹…åŒ–ä¼šå°†è¢«æ‰§è¡Œçš„å†™å‘½ä»¤å†™åˆ°AOFçš„æ–‡ä»¶æœ«å°¾ï¼Œä»¥æ­¤æ¥è®°å½•æ•°æ®å‘ç”Ÿçš„å˜ï¼Œå› æ­¤åªè¦redisä»å¤´åˆ°å°¾æ‰§è¡Œä¸€æ¬¡AOFæ–‡ä»¶æ‰€åŒ…å«çš„æ‰€æœ‰å†™å‘½ä»¤ï¼Œå°±å¯ä»¥æ¢å¤AOFæ–‡ä»¶çš„è®°å½•çš„æ•°æ®é›†ã€‚</p>
<blockquote>
<p>å¼€å¯AOFæŒä¹…åŒ–å‚è€ƒï¼š<a href="../../../Develop/%E5%BC%80%E5%8F%91%E8%99%9A%E6%8B%9F%E6%9C%BA/Docker%20%E5%AE%89%E8%A3%85%E5%AE%B9%E5%99%A8%E5%90%88%E9%9B%86.md#Redis%E6%8C%81%E4%B9%85%E5%8C%96">RedisæŒä¹…åŒ–</a><br>å¼€å¯åï¼Œå¤šäº†ä¸€ä¸ª<code>appendonly.aof</code>æ–‡ä»¶<br><img src="/Resources/Pasted%20image%2020220916164124.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<h4 id="æ—¥å¿—è¿½åŠ é¢‘ç‡"><a href="#æ—¥å¿—è¿½åŠ é¢‘ç‡" class="headerlink" title="æ—¥å¿—è¿½åŠ é¢‘ç‡"></a>æ—¥å¿—è¿½åŠ é¢‘ç‡</h4><p><strong>alwaysã€è°¨æ…ä½¿ç”¨ã€‘</strong></p>
<ul>
<li>è¯´æ˜ï¼šæ¯ä¸ªrediså†™å‘½ä»¤éƒ½è¦åŒæ­¥å†™å…¥ç¡¬ç›˜ï¼Œä¸¥é‡é™ä½redisé€Ÿåº¦</li>
<li>è§£é‡Šï¼šå¦‚æœç”¨æˆ·ä½¿ç”¨äº†alwaysé€‰é¡¹ï¼Œé‚£ä¹ˆæ¯ä¸ªrediså†™å‘½ä»¤éƒ½ä¼šè¢«å†™å…¥ç¡¬ç›˜ï¼Œä»è€Œå°†å‘ç”Ÿç³»ç»Ÿå´©æºƒæ—¶å‡ºç°çš„æ•°æ®ä¸¢å¤±å‡åˆ°æœ€å°‘ï¼›é—æ†¾çš„æ˜¯ï¼Œå› ä¸ºè¿™ç§åŒæ­¥ç­–ç•¥éœ€è¦å¯¹ç¡¬ç›˜è¿›è¡Œå¤§é‡çš„å†™å…¥æ“ä½œï¼Œæ‰€ä»¥rediså¤„ç†å‘½ä»¤çš„é€Ÿåº¦ä¼šå—åˆ°ç¡¬ç›˜æ€§èƒ½çš„é™åˆ¶ï¼›</li>
<li>æ³¨æ„ï¼šè½¬ç›˜å¼ç¡¬ç›˜åœ¨è¿™ç§é¢‘ç‡ä¸‹200å·¦å³ä¸ªå‘½ä»¤&#x2F;sï¼›å›ºæ€ç¡¬ç›˜(SSD)å‡ ç™¾ä¸‡ä¸ªå‘½ä»¤&#x2F;sï¼›</li>
<li>è­¦å‘Šï¼šä½¿ç”¨SSDç”¨æˆ·è¯·è°¨æ…ä½¿ç”¨alwaysé€‰é¡¹ï¼Œè¿™ç§æ¨¡å¼ä¸æ–­å†™å…¥å°‘é‡æ•°æ®çš„åšæ³•æœ‰å¯èƒ½ä¼šå¼•å‘ä¸¥é‡çš„<strong>å†™å…¥æ”¾å¤§</strong>ï¼ˆä¸æ–­å¾€ç£ç›˜å†™å…¥å°æ–‡ä»¶ï¼‰é—®é¢˜ï¼Œå¯¼è‡´å°†å›ºæ€ç¡¬ç›˜çš„å¯¿å‘½ä»åŸæ¥çš„å‡ å¹´é™ä½ä¸ºå‡ ä¸ªæœˆã€‚</li>
</ul>
<p><strong>everysecã€æ¨èã€‘ï¼ˆé»˜è®¤ï¼‰</strong></p>
<ul>
<li>è¯´æ˜ï¼šæ¯ç§’æ‰§è¡Œä¸€æ¬¡åŒæ­¥æ˜¾å¼çš„å°†å¤šä¸ªå†™å‘½ä»¤åŒæ­¥åˆ°ç£ç›˜</li>
<li>è§£é‡Šï¼šä¸ºäº†å…¼é¡¾æ•°æ®å®‰å…¨å’Œå†™å…¥æ€§èƒ½ï¼Œç”¨æˆ·å¯ä»¥è€ƒè™‘ä½¿ç”¨everysecé€‰é¡¹ï¼Œè®©redisæ¯ç§’ä¸€æ¬¡çš„é¢‘ç‡å¯¹AOFæ–‡ä»¶è¿›è¡ŒåŒæ­¥ï¼›redisæ¯ç§’åŒæ­¥ä¸€æ¬¡AOFæ–‡ä»¶æ—¶æ€§èƒ½å’Œä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–ç‰¹æ€§æ—¶çš„æ€§èƒ½ç›¸å·®æ— å‡ ï¼Œè€Œé€šè¿‡æ¯ç§’åŒæ­¥ä¸€æ¬¡AOFæ–‡ä»¶ï¼Œrediså¯ä»¥ä¿è¯ï¼Œå³ä½¿ç³»ç»Ÿå´©æºƒï¼Œç”¨æˆ·æœ€å¤šä¸¢å¤±ä¸€ç§’ä¹‹å†…äº§ç”Ÿçš„æ•°æ®ã€‚</li>
</ul>
<p><strong>noã€ä¸æ¨èã€‘</strong></p>
<ul>
<li>è¯´æ˜ï¼šç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶åŒæ­¥</li>
<li>è§£é‡Šï¼šæœ€åä½¿ç”¨noé€‰é¡¹ï¼Œå°†å®Œå…¨ç”±æ“ä½œç³»ç»Ÿå†³å®šä»€ä¹ˆæ—¶å€™åŒæ­¥AOFæ—¥å¿—æ–‡ä»¶ï¼Œè¿™ä¸ªé€‰é¡¹ä¸ä¼šå¯¹redisæ€§èƒ½å¸¦æ¥å½±å“ã€‚ä½†æ˜¯ç³»ç»Ÿå´©æºƒæ—¶ï¼Œä¼šä¸¢å¤±ä¸å®šæ•°é‡çš„æ•°æ®ï¼Œå¦å¤–å¦‚æœç”¨æˆ·ç¡¬ç›˜å¤„ç†å†™å…¥æ“ä½œä¸å¤Ÿå¿«çš„è¯ï¼Œå½“ç¼“å†²åŒºè¢«ç­‰å¾…å†™å…¥ç¡¬ç›˜æ•°æ®å¡«æ»¡æ—¶ï¼Œredisä¼šå¤„äºé˜»å¡çŠ¶æ€ï¼Œå¹¶å¯¼è‡´redisçš„å¤„ç†å‘½ä»¤è¯·æ±‚çš„é€Ÿåº¦å˜æ…¢ã€‚</li>
</ul>
<h4 id="AOFæ–‡ä»¶çš„é‡å†™"><a href="#AOFæ–‡ä»¶çš„é‡å†™" class="headerlink" title="AOFæ–‡ä»¶çš„é‡å†™"></a>AOFæ–‡ä»¶çš„é‡å†™</h4><h5 id="AOFå¸¦æ¥çš„é—®é¢˜"><a href="#AOFå¸¦æ¥çš„é—®é¢˜" class="headerlink" title="AOFå¸¦æ¥çš„é—®é¢˜"></a>AOFå¸¦æ¥çš„é—®é¢˜</h5><p>AOFçš„æ–¹å¼ä¹ŸåŒæ—¶å¸¦æ¥äº†å¦ä¸€ä¸ªé—®é¢˜ã€‚æŒä¹…åŒ–æ–‡ä»¶ä¼šå˜çš„è¶Šæ¥è¶Šå¤§ã€‚ä¾‹å¦‚æˆ‘ä»¬è°ƒç”¨incr testå‘½ä»¤100æ¬¡ï¼Œæ–‡ä»¶ä¸­å¿…é¡»ä¿å­˜å…¨éƒ¨çš„100æ¡å‘½ä»¤ï¼Œå…¶å®æœ‰99æ¡éƒ½æ˜¯å¤šä½™çš„ã€‚å› ä¸ºè¦æ¢å¤æ•°æ®åº“çš„çŠ¶æ€å…¶å®æ–‡ä»¶ä¸­ä¿å­˜ä¸€æ¡set test 100å°±å¤Ÿäº†ã€‚ä¸ºäº†å‹ç¼©aofçš„æŒä¹…åŒ–æ–‡ä»¶ï¼ŒRedisæä¾›äº†<strong>AOFé‡å†™ï¼ˆReWriterï¼‰æœºåˆ¶</strong>ã€‚</p>
<h5 id="AOFé‡å†™æœºåˆ¶"><a href="#AOFé‡å†™æœºåˆ¶" class="headerlink" title="AOFé‡å†™æœºåˆ¶"></a>AOFé‡å†™æœºåˆ¶</h5><p><strong>å®¢æˆ·ç«¯æ–¹å¼è§¦å‘é‡å†™</strong></p>
<ul>
<li>æ‰§è¡Œ <code>BGREWRITEAOF</code> å‘½ä»¤ï¼ˆè¯¥å‘½ä»¤ä¸ä¼šé˜»å¡redisçš„æœåŠ¡ï¼‰</li>
</ul>
<p><strong>æœåŠ¡å™¨é…ç½®æ–¹å¼è‡ªåŠ¨è§¦å‘</strong></p>
<ul>
<li>é…ç½®<code>redis.conf</code>ä¸­çš„<code>auto-aof-rewrite-percentage</code>å’Œ<code>auto-aof-rewrite-min-size</code>é€‰é¡¹</li>
<li>å¦‚æœè®¾ç½®<code>auto-aof-rewrite-percentage 100</code>å’Œ<code>auto-aof-rewrite-min-size 64mb</code>ï¼Œå¹¶ä¸”å¯ç”¨çš„AOFæŒä¹…åŒ–æ—¶ï¼Œé‚£ä¹ˆå½“AOFæ–‡ä»¶ä½“ç§¯å¤§äº64Mï¼Œå¹¶ä¸”AOFæ–‡ä»¶çš„ä½“ç§¯æ¯”ä¸Šä¸€æ¬¡é‡å†™ä¹‹åä½“ç§¯å¤§äº†è‡³å°‘ä¸€å€(100%)æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘ã€‚å¦‚æœé‡å†™è¿‡äºé¢‘ç¹ï¼Œç”¨æˆ·å¯ä»¥è€ƒè™‘å°†<code>auto-aof-rewrite-percentage</code>è®¾ç½®ä¸ºæ›´å¤§ã€‚</li>
</ul>
<blockquote>
<p><code>auto-aof-rewrite-percentage</code>å’Œ<code>auto-aof-rewrite-min-size</code>å¯èƒ½è§£é‡Šä¸å¤ªå¯¹ï¼Œç¿»çœ‹å®˜æ–¹æ–‡æ¡£åéœ€è¦æŸ¥çœ‹é…ç½®æ–‡ä»¶è¯´æ˜<br><img src="/Resources/Pasted%20image%2020220919094207.png" srcset="/img/loading.gif" lazyload></p>
<p>æŸ¥çœ‹é…ç½®æ–‡ä»¶è¯´æ˜<br><img src="/Resources/Pasted%20image%2020220919094655.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<h5 id="é‡å†™åŸç†"><a href="#é‡å†™åŸç†" class="headerlink" title="é‡å†™åŸç†"></a>é‡å†™åŸç†</h5><p>æ³¨æ„ï¼šé‡å†™aofæ–‡ä»¶çš„æ“ä½œï¼Œå¹¶æ²¡æœ‰è¯»å–æ—§çš„aofæ–‡ä»¶ï¼Œè€Œæ˜¯å°†æ•´ä¸ªå†…å­˜ä¸­çš„æ•°æ®åº“å†…å®¹ç”¨å‘½ä»¤çš„æ–¹å¼é‡å†™äº†ä¸€ä¸ªæ–°çš„aofæ–‡ä»¶ï¼Œæ›¿æ¢åŸæœ‰çš„æ–‡ä»¶ã€‚è¿™ç‚¹å’Œå¿«ç…§æœ‰ç‚¹ç±»ä¼¼ã€‚</p>
<p><strong>é‡å†™æµç¨‹</strong>ï¼š</p>
<ul>
<li><ol>
<li>redisè°ƒç”¨fork ï¼Œç°åœ¨æœ‰çˆ¶å­ä¸¤ä¸ªè¿›ç¨‹ï¼Œå­è¿›ç¨‹æ ¹æ®å†…å­˜ä¸­çš„æ•°æ®åº“å¿«ç…§ï¼Œå¾€ä¸´æ—¶æ–‡ä»¶ä¸­å†™å…¥é‡å»ºæ•°æ®åº“çŠ¶æ€çš„å‘½ä»¤ã€‚</li>
</ol>
</li>
<li><ol start="2">
<li>çˆ¶è¿›ç¨‹ç»§ç»­å¤„ç†clientè¯·æ±‚ï¼Œé™¤äº†æŠŠå†™å‘½ä»¤å†™å…¥åˆ°åŸæ¥çš„aofæ–‡ä»¶ä¸­ã€‚åŒæ—¶æŠŠæ”¶åˆ°çš„å†™å‘½ä»¤ç¼“å­˜èµ·æ¥ã€‚è¿™æ ·å°±èƒ½ä¿è¯å¦‚æœå­è¿›ç¨‹é‡å†™å¤±è´¥çš„è¯å¹¶ä¸ä¼šå‡ºé—®é¢˜ã€‚</li>
</ol>
</li>
<li><ol start="3">
<li>å½“å­è¿›ç¨‹æŠŠå¿«ç…§å†…å®¹å†™å…¥å·²å‘½ä»¤æ–¹å¼å†™åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­åï¼Œå­è¿›ç¨‹å‘ä¿¡å·é€šçŸ¥çˆ¶è¿›ç¨‹ã€‚ç„¶åçˆ¶è¿›ç¨‹æŠŠç¼“å­˜çš„å†™å‘½ä»¤ä¹Ÿå†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶ã€‚</li>
</ol>
</li>
<li><ol start="4">
<li>ç°åœ¨çˆ¶è¿›ç¨‹å¯ä»¥ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶æ›¿æ¢è€çš„aofæ–‡ä»¶ï¼Œå¹¶é‡å‘½åï¼Œåé¢æ”¶åˆ°çš„å†™å‘½ä»¤ä¹Ÿå¼€å§‹å¾€æ–°çš„aofæ–‡ä»¶ä¸­è¿½åŠ ã€‚</li>
</ol>
</li>
</ul>
<p><img src="/Resources/Pasted%20image%2020220919101504.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="10ã€Javaæ“ä½œRedis"><a href="#10ã€Javaæ“ä½œRedis" class="headerlink" title="10ã€Javaæ“ä½œRedis"></a>10ã€Javaæ“ä½œRedis</h2><h3 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h3><h3 id="å¯¼å…¥ä¾èµ–"><a href="#å¯¼å…¥ä¾èµ–" class="headerlink" title="å¯¼å…¥ä¾èµ–"></a>å¯¼å…¥ä¾èµ–</h3><p><a target="_blank" rel="noopener" href="https://mvnrepository.com/">Maven Repository: Search&#x2F;Browse&#x2F;Explore</a><br>æœç´¢<code>jedis</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/redis.clients/jedis --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.3.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.76<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="ç¼–ç æµ‹è¯•"><a href="#ç¼–ç æµ‹è¯•" class="headerlink" title="ç¼–ç æµ‹è¯•"></a>ç¼–ç æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestPing</span> &#123;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-comment">// 1. new Jedis å¯¹è±¡å³å¯  </span><br>        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">6379</span>);  <br>        <span class="hljs-comment">// jedis æ‰€æœ‰çš„å‘½ä»Šå°±æ˜¯æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„æ‰€æœ‰æŒ‡ä»¤!  </span><br>        System.out.println(jedis.ping());  <br>    &#125;<br>&#125; <br>output:<br>PONG<br></code></pre></td></tr></table></figure>

<h3 id="å¸¸ç”¨çš„API"><a href="#å¸¸ç”¨çš„API" class="headerlink" title="å¸¸ç”¨çš„API"></a>å¸¸ç”¨çš„API</h3><h2 id="11-Springbootæ•´åˆRedis"><a href="#11-Springbootæ•´åˆRedis" class="headerlink" title="11. Springbootæ•´åˆRedis"></a>11. Springbootæ•´åˆRedis</h2><p>Spring Boot Data Redis ä¸­æä¾›äº† RedisTemplateå’ŒStringRedisTemplateã€‚<br>å…¶ä¸­StringRedisTemplateæ˜¯RedisTemplateçš„å­ç±»</p>
<ul>
<li><strong>RedisTemplate</strong><br>ä¸¤ä¸ªæ³›å‹éƒ½æ˜¯Objectï¼Œæ„å‘³ç€å­˜å‚¨çš„keyå’Œvalue éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡</li>
<li><strong>StringRedisTemplate</strong><br>ä¸¤ä¸ªæ³›å‹éƒ½æ˜¯String,æ„å‘³ç€StringRedisTemplateçš„keyå’Œvalueéƒ½åªèƒ½æ˜¯å­—ç¬¦ä¸²</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼šä½¿ç”¨RedisTemplateé»˜è®¤æ˜¯å°†å¯¹è±¡åºåˆ—åŒ–åˆ°Redisä¸­ï¼Œæ‰€ä»¥æ”¾å…¥çš„å¯¹è±¡å¿…é¡»å®ç°å¯¹è±¡åºåˆ—åŒ–æ¥å£</p>
</blockquote>
<h3 id="1-å¼•å…¥ä¾èµ–"><a href="#1-å¼•å…¥ä¾èµ–" class="headerlink" title="1. å¼•å…¥ä¾èµ–"></a>1. å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--        Spring date redis--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="1-é…ç½®applicaiton-yml"><a href="#1-é…ç½®applicaiton-yml" class="headerlink" title="1. é…ç½®applicaiton.yml"></a>1. é…ç½®applicaiton.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment"># redis  </span><br><span class="hljs-attr">redis:</span>  <br>  <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>  <br>  <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>  <br>  <span class="hljs-attr">database:</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<h3 id="2-æµ‹è¯•ä½¿ç”¨StringRedisTemplate"><a href="#2-æµ‹è¯•ä½¿ç”¨StringRedisTemplate" class="headerlink" title="2. æµ‹è¯•ä½¿ç”¨StringRedisTemplate"></a>2. æµ‹è¯•ä½¿ç”¨StringRedisTemplate</h3><p><code>opsForValue()</code>å°±æ˜¯<code>redis</code>ä¸­çš„<code>String</code><br><code>opsForList()</code>å°±æ˜¯<code>redis</code>ä¸­çš„<code>list</code><br><code>....</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestStringRedisTemplate</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ³¨å…¥SpringRedisTemplate</span><br><span class="hljs-comment">     * SpringRedisTemplateçš„keyå’Œvalueéƒ½æ˜¯Stringç±»å‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> StringRedisTemplate stringRedisTemplate;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ“ä½œredisä¸­keyç›¸å…³çš„</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testKey</span><span class="hljs-params">()</span> &#123;<br><br>        <span class="hljs-comment">// åˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨</span><br>        <span class="hljs-type">Boolean</span> <span class="hljs-variable">hasKey</span> <span class="hljs-operator">=</span> stringRedisTemplate.hasKey(<span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(hasKey);<br><br>        <span class="hljs-comment">// åˆ é™¤ä¸€ä¸ªkey</span><br>        <span class="hljs-type">Boolean</span> <span class="hljs-variable">aBoolean</span> <span class="hljs-operator">=</span> stringRedisTemplate.delete(<span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(aBoolean);<br><br>        <span class="hljs-comment">// åˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨</span><br>        <span class="hljs-type">Boolean</span> <span class="hljs-variable">hasKeys</span> <span class="hljs-operator">=</span> stringRedisTemplate.hasKey(<span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(hasKeys);<br><br>        <span class="hljs-comment">// åˆ¤æ–­keyå¯¹åº”å€¼çš„ç±»å‹</span><br>        <span class="hljs-type">DataType</span> <span class="hljs-variable">type</span> <span class="hljs-operator">=</span> stringRedisTemplate.type(<span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(type);<br><br>        <span class="hljs-comment">// åˆ¤æ–­redisä¸­æ‰€æœ‰çš„key</span><br>        Set&lt;String&gt; keys = stringRedisTemplate.keys(<span class="hljs-string">&quot;*&quot;</span>);<br>        System.out.println(keys);<br><br>        <span class="hljs-comment">// è·å–keyå€¼çš„è¿‡æœŸäº‹ä»¶</span><br>        <span class="hljs-type">Long</span> <span class="hljs-variable">expire</span> <span class="hljs-operator">=</span> stringRedisTemplate.getExpire(<span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(expire);<br><br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testList</span><span class="hljs-params">()</span> &#123;<br>        stringRedisTemplate.opsForList().leftPush(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;wtt&quot;</span>);<br>        stringRedisTemplate.opsForList().leftPushAll(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;wtt&quot;</span>, <span class="hljs-string">&quot;wttt&quot;</span>, <span class="hljs-string">&quot;wtttt&quot;</span>);<br>        <span class="hljs-comment">// åœ¨redis-cliä¸­æŸ¥çœ‹list ä½¿ç”¨LRANGE name 0 -1</span><br>        List&lt;String&gt; list = stringRedisTemplate.opsForList().range(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">assert</span> list != <span class="hljs-literal">null</span>;<br>        list.forEach(value -&gt; System.out.println(value));<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSet</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">// åˆ›å»ºSet</span><br>        stringRedisTemplate.opsForSet().add(<span class="hljs-string">&quot;nameSet&quot;</span>, <span class="hljs-string">&quot;wt&quot;</span>,<span class="hljs-string">&quot;wtt&quot;</span>,<span class="hljs-string">&quot;wt&quot;</span>);<br>        <span class="hljs-comment">// æŸ¥çœ‹Set</span><br>        Set&lt;String&gt; set = stringRedisTemplate.opsForSet().members(<span class="hljs-string">&quot;nameSet&quot;</span>);<br>        <span class="hljs-keyword">assert</span> set != <span class="hljs-literal">null</span>;<br>        set.forEach(string-&gt; System.out.println(string));<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testZSet</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">// åˆ›å»ºZSet</span><br>        stringRedisTemplate.opsForZSet().add(<span class="hljs-string">&quot;zsets&quot;</span>, <span class="hljs-string">&quot;wt&quot;</span>,<span class="hljs-number">13</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testHash</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªhashç±»å‹å¹¶æ”¾å…¥key value</span><br>        stringRedisTemplate.opsForHash().put(<span class="hljs-string">&quot;maps&quot;</span>,<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;wtt&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ“ä½œredisä¸­å­—ç¬¦ä¸² opsForValueå®é™…æ“ä½œå°±æ˜¯redisä¸­çš„Stringç±» å‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// è®¾ç½®ä¸€ä¸ª key value</span><br>        stringRedisTemplate.opsForValue().set(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;wtt&quot;</span>);<br>        <span class="hljs-comment">// è·å–key å¯¹åº”çš„value</span><br>        stringRedisTemplate.opsForValue().get(<span class="hljs-string">&quot;name&quot;</span>);<br>        <span class="hljs-comment">// è®¾ç½®ä¸€ä¸ª key value expireTime</span><br>        stringRedisTemplate.opsForValue().set(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;wtt&quot;</span>, <span class="hljs-number">120</span>, TimeUnit.SECONDS);<br>        <span class="hljs-comment">// è¿½åŠ value</span><br>        stringRedisTemplate.opsForValue().append(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;lihai&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure>

<h3 id="3-æµ‹è¯•ä½¿ç”¨RedisTemplate"><a href="#3-æµ‹è¯•ä½¿ç”¨RedisTemplate" class="headerlink" title="3. æµ‹è¯•ä½¿ç”¨RedisTemplate"></a>3. æµ‹è¯•ä½¿ç”¨RedisTemplate</h3><p>![[redistemplate 2.png]]<br><code>RedisTemplate</code>å­˜è¿›<code>redis</code>ä¸­çš„æ•°æ®éƒ½æ˜¯ç»è¿‡åºåˆ—åŒ–çš„ï¼Œæ‰€ä»¥æ”¾å…¥çš„å¯¹è±¡å¿…é¡»å®ç°å¯¹è±¡åºåˆ—åŒ–æ¥å£ã€‚å› æ­¤ä½¿ç”¨<code>RedisTemplate</code>æ‹¿ä¸åˆ°é€šè¿‡<code>StringRedisTemplate</code>å­˜è¿›å»çš„æ•°æ®</p>
<hr>
<p>ä½†æ˜¯æˆ‘ä»¬å¸¸å¸¸ç”¨<code>String</code>è¡¨ç¤º<code>key</code>ï¼Œå¯¹è±¡è¡¨ç¤º<code>value</code>ï¼Œå› æ­¤å¯ä»¥ä¿®æ”¹åºåˆ—åŒ–çš„æ–¹å¼ã€‚<br>é»˜è®¤çš„åºåˆ—åŒ–æ–¹å¼æ˜¯<code>JdkSerializationRedisSerializer</code><br>![[Pasted image 20220705194854.png]]</p>
<hr>
<p>ä¿®æ”¹é»˜è®¤åºåˆ—åŒ–æ–¹æ¡ˆ<br><code>redisTemplate.setKeySerializer(new StringRedisSerializer());</code></p>
<blockquote>
<p>ä½†æ˜¯å¯¹äºhashmapæ¥è¯´ï¼Œ![[Pasted image 20220705201037.png]]æœ‰ä¸¤ä¸ªkeyå€¼ï¼Œä½¿ç”¨ä¸Šè¿°æ–¹æ¡ˆï¼Œåªä¼šä¿®æ”¹ç¬¬ä¸€ä¸ªkeyçš„é»˜è®¤åºåˆ—åŒ–æ–¹æ¡ˆï¼Œå› æ­¤å¦‚æœæƒ³ä¿®æ”¹ç¬¬äºŒä¸ªçš„é»˜è®¤åºåˆ—åŒ–æ–¹æ¡ˆï¼Œè¿˜éœ€è¦ä¿®æ”¹hashkeyçš„åºåˆ—åŒ–<code>redisTemplate.setHashKeySerializer(new StringRedisSerializer());</code></p>
</blockquote>
<h3 id="4-RedisTemplateå’ŒStringRedisTemplateçš„bound-api"><a href="#4-RedisTemplateå’ŒStringRedisTemplateçš„bound-api" class="headerlink" title="4. RedisTemplateå’ŒStringRedisTemplateçš„bound api"></a>4. RedisTemplateå’ŒStringRedisTemplateçš„bound api</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testBound</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">//spring data ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬å¯¹redisè¿›è¡Œæ›´å‹å¥½çš„æ“ä½œ å› æ­¤æä¾›äº†bound api ç®€åŒ–æ“ä½œ</span><br>    redisTemplate.setKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br>    redisTemplate.setHashKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br><br>    stringredisTemplate.opsForValue().set(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;wtt&quot;</span>);<br>    stringredisTemplate.opsForValue().append(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;lihai!&quot;</span>);<br>    stringredisTemplate.opsForValue().get(<span class="hljs-string">&quot;name&quot;</span>);<br><br>    <span class="hljs-comment">//å¯¹å­—ç¬¦ä¸²ç±»å‹keyè¿›è¡Œç»‘å®šåç»­æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸºäºè¿™ä¸ªkeyçš„æ“ä½œ</span><br>    BoundValueOperations&lt;String, String&gt; name = stringredisTemplate.boundValueOps(<span class="hljs-string">&quot;name&quot;</span>);<br>    name.set(<span class="hljs-string">&quot;wtt&quot;</span>);<br>    name.append(<span class="hljs-string">&quot;lihailiahi!&quot;</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<ol>
<li>é’ˆå¯¹äºæ—¥åå¤„ç†çš„key value éƒ½æ˜¯ String ä½¿ç”¨ StringRedisTemplate </li>
<li>é’ˆå¯¹äºæ—¥åå¤„ç†çš„key value éƒ½æ˜¯å¯¹è±¡ä½¿ç”¨ RedisTemplate </li>
<li>é’ˆå¯¹äºåŒä¸€ä¸ªkeyå¤šæ¬¡æ“ä½œå¯ä»¥ä½¿ç”¨boundxxxOps () Value List Set Iset Hashçš„api ç®€åŒ–ä¹¦å†™</li>
</ol>
</blockquote>
<h2 id="12ã€Redisåº”ç”¨åœºæ™¯"><a href="#12ã€Redisåº”ç”¨åœºæ™¯" class="headerlink" title="12ã€Redisåº”ç”¨åœºæ™¯"></a>12ã€Redisåº”ç”¨åœºæ™¯</h2><ol>
<li>åˆ©ç”¨redisä¸­å­—ç¬¦ä¸²ç±»å‹å®Œæˆé¡¹ç›®ä¸­æ‰‹æœº<strong>éªŒè¯ç å­˜å‚¨</strong>çš„å®ç°</li>
<li>åˆ©ç”¨redisä¸­å­—ç¬¦ä¸²ç±»å‹å®Œæˆå…·æœ‰<strong>æ—¶æ•ˆæ€§ä¸šåŠ¡</strong>åŠŸèƒ½ï¼Œå¦‚è®¢å•è¶…æ—¶ï¼Œç”¨æˆ·ä¿¡æ¯token<ul>
<li>12306</li>
<li>æ·˜å®</li>
</ul>
</li>
<li>åˆ©ç”¨redisä¸­åˆ†å¸ƒå¼é›†ç¾¤ç³»ç»Ÿ<strong>sessionå…±äº«</strong></li>
<li>åˆ©ç”¨redisä¸­çš„zsetç±»å‹ï¼Œå®ç°å¦‚<strong>æ’è¡Œæ¦œ</strong>ä¹‹ç±»åŠŸèƒ½ <ul>
<li>dangdangé”€é‡æ’è¡Œsales(zset)[å•†å“id,å•†å“é”€é‡]</li>
</ul>
</li>
<li>åˆ©ç”¨rediså®ç°<strong>åˆ†å¸ƒå¼ç¼“å­˜</strong></li>
<li>åˆ©ç”¨redisè§£å†³åˆ†å¸ƒå¼é›†ç¾¤ç³»ç»Ÿä¸­<strong>åˆ†å¸ƒå¼é”é—®é¢˜</strong></li>
</ol>
<h3 id="åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸€ï¼‰"><a href="#åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸€ï¼‰" class="headerlink" title="åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸€ï¼‰"></a>åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸€ï¼‰</h3><ul>
<li><ol>
<li>ç¼“å­˜ï¼ˆCacheï¼‰ï¼šè®¡ç®—æœºå†…å­˜ä¸­çš„ä¸€æ®µæ•°æ®</li>
</ol>
</li>
<li><ol start="2">
<li>ç‰¹ç‚¹</li>
</ol>
<ul>
<li>è¯»å†™å¿«</li>
<li>æ–­ç”µç«‹å³ä¸¢å¤±</li>
</ul>
</li>
<li><ol start="3">
<li>è§£å†³é—®é¢˜</li>
</ol>
<ul>
<li>æé«˜ç½‘ç«™ååé‡æé«˜ç½‘ç«™è¿è¡Œæ•ˆç‡</li>
<li><strong>æ ¸å¿ƒè§£å†³é—®é¢˜</strong>ï¼šç¼“å­˜çš„å­˜åœ¨æ˜¯ç”¨æ¥å‡è½»æ•°æ®åº“è®¿é—®å‹åŠ›</li>
<li>æ³¨æ„ï¼šä½¿ç”¨ç¼“å­˜æ—¶ä¸€å®šæ˜¯æ•°æ®åº“ä¸­æ•°æ®<strong>æå°‘å‘ç”Ÿä¿®æ”¹</strong>ï¼Œæ›´å¤šç”¨äºæŸ¥è¯¢è¿™ç§æƒ…å†µï¼ˆæœ‰ç‚¹ç±»ä¼¼mysqlä¸­çš„ç´¢å¼•ï¼‰</li>
</ul>
</li>
<li><ol start="4">
<li>æœ¬åœ°ç¼“å­˜ä¸åˆ†å¸ƒå¼ç¼“å­˜</li>
</ol>
<ul>
<li>æœ¬åœ°ç¼“å­˜ï¼ˆlocal cacheï¼‰<ul>
<li>å­˜åœ¨åº”ç”¨æœåŠ¡å™¨å†…å­˜ä¸­æ•°æ®ç§°ä¹‹ä¸ºæœ¬åœ°ç¼“å­˜</li>
<li>æœ¬åœ°ç¼“å­˜ä¼šéšç€åº”ç”¨çš„å…³é—­ä¸¢å¤±</li>
</ul>
</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆdistribute cacheï¼‰<ul>
<li>å­˜å‚¨åœ¨å½“å‰åº”ç”¨æœåŠ¡å™¨å†…å­˜ä¹‹å¤–æ•°æ®ç§°ä¹‹ä¸ºåˆ†å¸ƒå¼ç¼“å­˜</li>
</ul>
</li>
<li>é›†ç¾¤<ul>
<li>å°†<strong>åŒä¸€ç§æœåŠ¡çš„å¤šä¸ªèŠ‚ç‚¹</strong>æ”¾åœ¨ä¸€èµ·å…±åŒå¯¹ç³»ç»Ÿæä¾›æœåŠ¡è¿‡ç¨‹ï¼Œç§°ä¹‹ä¸ºé›†ç¾¤</li>
</ul>
</li>
<li>åˆ†å¸ƒå¼<ul>
<li><strong>æœ‰å¤šä¸ªä¸åŒæœåŠ¡é›†ç¾¤</strong>åŠŸèƒ½å¯¹ç³»ç»Ÿæä¾›æœåŠ¡ï¼Œè¿™ä¸ªç³»ç»Ÿç§°ä¹‹ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿ</li>
</ul>
</li>
</ul>
</li>
<li><ol start="5">
<li>åˆ©ç”¨mybatisè‡ªèº«æœ¬åœ°ç¼“å­˜ç»“åˆrediså®ç°åˆ†å¸ƒå¼ç¼“å­˜</li>
</ol>
<ul>
<li>mybatisä¸­åº”ç”¨çº§ç¼“å­˜ï¼ˆäºŒçº§ç¼“å­˜ï¼‰  <ul>
<li>sqlsessionFactoryçº§åˆ«ç¼“å­˜  æ‰€æœ‰ä¼šè¯å…±äº«</li>
</ul>
</li>
<li>å¦‚ä½•å¼€å¯åº”ç”¨çº§ç¼“å­˜ï¼ˆäºŒçº§ç¼“å­˜ï¼‰<ul>
<li>åœ¨mapper.xmlä¸­åŠ å…¥æ ‡ç­¾<code>&lt;cache/&gt;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="æ­å»ºMybatisæœ¬åœ°ç¼“å­˜ç¯å¢ƒ"><a href="#æ­å»ºMybatisæœ¬åœ°ç¼“å­˜ç¯å¢ƒ" class="headerlink" title="æ­å»ºMybatisæœ¬åœ°ç¼“å­˜ç¯å¢ƒ"></a>æ­å»ºMybatisæœ¬åœ°ç¼“å­˜ç¯å¢ƒ</h4><blockquote>
<p>åŸºæœ¬ç¯å¢ƒæ­å»ºå‚è€ƒï¼š<a href="../../Spring/SpringBoot/SpringBoot.md#%E5%9C%A8SpringBoot%E4%B8%AD%E9%9B%86%E6%88%90Mybatis">åœ¨SpringBootä¸­é›†æˆMybatis</a><br>æ³¨æ„ï¼šå¦‚æœè¦ä½¿ç”¨mybatisè‡ªèº«æœ¬åœ°ç¼“å­˜ï¼Œentityå¯¹è±¡å¿…é¡»å®ç°å¯¹è±¡åºåˆ—åŒ–<code>implements Serializable</code>ï¼›</p>
</blockquote>
<ul>
<li><p>å¼€å¯mybatisè‡ªèº«æœ¬åœ°ç¼“å­˜å‰<br><img src="/Resources/Pasted%20image%2020220919161137.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>å¼€å¯mybatisè‡ªèº«æœ¬åœ°ç¼“å­˜åï¼ˆå¼€å¯æ–¹å¼å¦‚ä¸‹ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--å¼€å¯mybatisäºŒçº§ç¼“å­˜--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">cache</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">cache</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;org.apache.ibatis.cache.impl.PerpetualCache&quot;</span>/&gt;</span><br><span class="hljs-comment">&lt;!--ç¬¬ä¸€ç§å’Œç¬¬äºŒç§æ•ˆæœç›¸åŒ--&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="/Resources/Pasted%20image%2020220919161033.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ul>
<h4 id="æ­å»ºRedisåˆ†å¸ƒå¼ç¼“å­˜ç¯å¢ƒ"><a href="#æ­å»ºRedisåˆ†å¸ƒå¼ç¼“å­˜ç¯å¢ƒ" class="headerlink" title="æ­å»ºRedisåˆ†å¸ƒå¼ç¼“å­˜ç¯å¢ƒ"></a>æ­å»ºRedisåˆ†å¸ƒå¼ç¼“å­˜ç¯å¢ƒ</h4><p><img src="/Resources/Pasted%20image%2020220919164355.png" srcset="/img/loading.gif" lazyload><br>é€šè¿‡æŸ¥çœ‹æºç å‘ç°ï¼Œmybatisä¸­çš„<code>PerpetualCache</code>ï¼Œå°†ç¼“å­˜putåˆ°å†…å­˜ä¸­ï¼Œä¸‹æ¬¡å–å¾—æ—¶å€™å†getï¼Œåº•å±‚ä½¿ç”¨çš„æ•°æ®ç»“æ„æ˜¯<code>HashMap</code>ï¼Œå› æ­¤<strong>ä½¿ç”¨Redisåˆ†å¸ƒå¼ç¼“å­˜åªéœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªCacheç±»å®ç°Cacheæ¥å£ï¼Œå¹¶å¯¹å…¶ä¸­çš„æ–¹æ³•æ¢æˆredisä¸­çš„æ–¹å¼å®ç°å³å¯</strong>ã€‚</p>
<p>æœ€åå†æŠŠtypeä¸­çš„ç±»åæ¢æˆè‡ªå®šä¹‰çš„Cacheç±»</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">cache</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;xxxx&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="å®ç°get-put"><a href="#å®ç°get-put" class="headerlink" title="å®ç°get put"></a>å®ç°get put</h5><p>æ–°å»ºä¸€ä¸ª<code>RedisCache</code>å®ç°<code>Cache</code>æ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisCache</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Cache</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putObject</span><span class="hljs-params">(Object o, Object o1)</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getObject</span><span class="hljs-params">(Object o)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">removeObject</span><span class="hljs-params">(Object o)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getSize</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å°†typeä¸­çš„ç±»åæ¢æˆè‡ªå®šä¹‰çš„Cacheç±»</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">cache</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.cqupt.cache.RedisCache&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<p>è¿è¡ŒæŠ¥é”™<br><img src="/Resources/Pasted%20image%2020220919170356.png" srcset="/img/loading.gif" lazyload></p>
<p>æŠ¥é”™ä¿¡æ¯ï¼šéœ€è¦å®šä¹‰ä¸€ä¸ªIDå’Œæ„é€ å™¨ï¼ˆä»¿ç…§mybatisçš„PerpetualCacheçš„ä»£ç æ·»åŠ idå’Œæ„é€ å™¨åå¹¶è¿è¡Œï¼‰<br><img src="/Resources/Pasted%20image%2020220919171051.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>é€šè¿‡æ§åˆ¶å°çš„ä¿¡æ¯å¯ä»¥å‘ç°ï¼šidæ˜¯mapperä¸­çš„namespace</p>
</blockquote>
<p>è¿è¡ŒæŠ¥é”™<br><img src="/Resources/Pasted%20image%2020220919170356.png" srcset="/img/loading.gif" lazyload></p>
<p>æŠ¥é”™ä¿¡æ¯ï¼šnameå€¼ä¸èƒ½ä¸ºç©ºï¼Œé‚£ä¹ˆå€¼å°±æ˜¯idå°±æ˜¯mapperä¸­çš„namespaceï¼Œæ‰€ä»¥åªéœ€è¦å°†<code>return null</code>æ”¹ä¸º<code>return this.id</code>å³å¯ã€‚<br><img src="/Resources/Pasted%20image%2020220919172257.png" srcset="/img/loading.gif" lazyload></p>
<p>ä»¥ä¸‹ä¸å†ä¸€ä¸€ä¸¾ä¾‹ï¼Œè§ä»£ç ä¸­æ³¨é‡Šè¯´æ˜ï¼›<br><img src="/Resources/Pasted%20image%2020220919173357.png" srcset="/img/loading.gif" lazyload></p>
<p><code>RedisCache</code> è‡ªå®šä¹‰Cacheç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisCache</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Cache</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å½“å‰æ”¾å…¥ç¼“å­˜çš„mapperçš„namespace</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String id;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¿…é¡»å­˜åœ¨æ„é€ æ–¹æ³•</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id å½“å‰æ”¾å…¥ç¼“å­˜çš„mapperçš„namespace</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RedisCache</span><span class="hljs-params">(String id)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;id======================&gt;&quot;</span> + id);<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è¿”å›cacheå”¯ä¸€æ ‡è¯†</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.id;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡RedisTemplateæˆ–è€…StringRedisTemplateæŠŠå€¼æ”¾å…¥redis</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key key</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> value value</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putObject</span><span class="hljs-params">(Object key, Object value)</span> &#123;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * é€šè¿‡applicationå·¥å…·ç±»è·å–redisTemplate</span><br><span class="hljs-comment">         * è¿™é‡Œä¸èƒ½ç›´æ¥ä½¿ç”¨</span><br><span class="hljs-comment">         * @autowired</span><br><span class="hljs-comment">         * private RedisTemplate redisTemplate</span><br><span class="hljs-comment">         * æ˜¯å› ä¸ºRedisCacheè¿™ä¸ªç±»æ˜¯ç”±mybatiså®ä¾‹åŒ–çš„ï¼Œè€Œä¸æ˜¯springå·¥å‚ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨æ³¨å…¥æ–¹å¼</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-type">RedisTemplate</span> <span class="hljs-variable">redisTemplate</span> <span class="hljs-operator">=</span> (RedisTemplate) ApplicationContextUtils.getBean(<span class="hljs-string">&quot;redisTemplate&quot;</span>);<br>        redisTemplate.setKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br>        redisTemplate.setHashKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * ä½¿ç”¨redis hashç±»å‹ä½œä¸ºç¼“å­˜å­˜å‚¨æ¨¡å‹&lt;key, &lt;hashKey,value&gt;&gt;</span><br><span class="hljs-comment">         * å…¶ä¸­keyæ˜¯mapperçš„namespace</span><br><span class="hljs-comment">         * hashKeyæ˜¯å…·ä½“çš„mapperä¸­çš„æŸä¸ªæ–¹æ³•</span><br><span class="hljs-comment">         * valueåˆ™æ˜¯æŸä¸ªæ–¹æ³•çš„è¿”å›å€¼</span><br><span class="hljs-comment">         */</span><br><br>        redisTemplate.opsForHash().put(id.toString(),key.toString(),value);<br><br>        System.out.println(<span class="hljs-string">&quot;key======================&gt;&quot;</span>+key.toString());<br>        System.out.println(<span class="hljs-string">&quot;value======================&gt;&quot;</span>+value);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getObject</span><span class="hljs-params">(Object key)</span> &#123;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * é€šè¿‡applicationå·¥å…·ç±»è·å–redisTemplate</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-type">RedisTemplate</span> <span class="hljs-variable">redisTemplate</span> <span class="hljs-operator">=</span> (RedisTemplate) ApplicationContextUtils.getBean(<span class="hljs-string">&quot;redisTemplate&quot;</span>);<br>        redisTemplate.setKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br>        redisTemplate.setHashKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * æ ¹æ®keyä»redisè·å–æ•°æ®</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> redisTemplate.opsForHash().get(id.toString(), key.toString());<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">removeObject</span><span class="hljs-params">(Object o)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getSize</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>ApplicationContextUtils</code></p>
<blockquote>
<p>å¯¹ApplicationContextAwareä¸å¤Ÿäº†è§£ï¼ä¸”<code>å› ä¸ºRedisCacheè¿™ä¸ªç±»æ˜¯ç”±mybatiså®ä¾‹åŒ–çš„ï¼Œè€Œä¸æ˜¯springå·¥å‚ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨æ³¨å…¥æ–¹å¼</code>è¿™å¥è¯ä¹Ÿä¸å¤ªç†è§£ï¼Rediså­¦å®Œåï¼Œå¤ä¹ Spring5!</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è·å–Springbootåˆ›å»ºå¥½çš„å·¥å‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ApplicationContextUtils</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ApplicationContextAware</span> &#123;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     * ä¿ç•™ä¸‹æ¥çš„å·¥å‚</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ApplicationContext applicationContext;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å°†åˆ›å»ºå¥½çš„å·¥å‚ä»¥å‚æ•°çš„å½¢å¼ä¼ é€’ç»™è¿™ä¸ªç±»</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> applicationContext å·¥å‚</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> BeansException</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setApplicationContext</span><span class="hljs-params">(ApplicationContext applicationContext)</span> <span class="hljs-keyword">throws</span> BeansException &#123;<br>        <span class="hljs-built_in">this</span>.applicationContext = applicationContext;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æä¾›å†å·¥å‚ä¸­è·å–å¯¹è±¡çš„æ–¹æ³•</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">getBean</span><span class="hljs-params">(String beanName)</span>&#123;<br>        <span class="hljs-keyword">return</span> applicationContext.getBean(beanName);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>UserServiceTest</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserService userService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span> &#123;<br>        userService.findAll().forEach(System.out::println);<br><br>        userService.findAll().forEach(System.out::println);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å®ç°ç»“æœ<br><img src="/Resources/Pasted%20image%2020220919193626.png" srcset="/img/loading.gif" lazyload></p>
<h5 id="å®ç°remove-clear"><a href="#å®ç°remove-clear" class="headerlink" title="å®ç°remove clear"></a>å®ç°remove clear</h5><p>Qï¼š<u>å¦‚æœåœ¨æŸ¥è¯¢çš„æ—¶å€™Redisä¸­æ­£å¥½æœ‰æ•°æ®ï¼Œä½†æ˜¯å‰ä¸€ç§’è¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆä»Redisæ‹¿å‡ºæ¥çš„æ•°æ®å°±æ˜¯æ—§æ•°æ®ã€‚ç±»ä¼¼äºä»¥ä¸‹</u></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">find<br>modify<br>find<br></code></pre></td></tr></table></figure>
<p>Aï¼š<u>æ¯å½“è¿›è¡Œä¿®æ”¹çš„æ—¶å€™ï¼Œå°±æŠŠç¼“å­˜æ¸…é™¤ï¼Œå³è§¦å‘ä¸‹é¢çš„clearæ–¹æ³•(ä¸æ˜¯removeObjectï¼Œmybatisç‰ˆæœ¬ä¸º2.1.3)</u><br><strong>ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼šclearæ¸…é™¤çš„æ˜¯keyä¸ºidï¼ˆnamespaceï¼‰çš„hashï¼Œå³æ¸…é™¤è¿™ä¸€ä¸ªmapperçš„æ‰€æœ‰ç¼“å­˜</strong></p>
<p>å®Œå–„ä¹‹å‰æ²¡æœ‰å†™å®Œçš„<code>removeObject</code>å’Œ<code>clear</code>æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ ¹æ®æŒ‡å®šçš„keyåˆ é™¤ç¼“å­˜ï¼ˆmybatisç°åœ¨è¿˜æ²¡æœ‰å®ç°è¯¥æ–¹æ³•ï¼Œä»¥åå¯èƒ½ä¼šå®ç°ï¼‰</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">removeObject</span><span class="hljs-params">(Object key)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ¸…ç©ºç¼“å­˜</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     * é€šè¿‡applicationå·¥å…·ç±»è·å–redisTemplate</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">RedisTemplate</span> <span class="hljs-variable">redisTemplate</span> <span class="hljs-operator">=</span> (RedisTemplate) ApplicationContextUtils.getBean(<span class="hljs-string">&quot;redisTemplate&quot;</span>);<br>    redisTemplate.setKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br>    redisTemplate.setHashKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     * æ¸…ç©ºnamespace</span><br><span class="hljs-comment">     */</span><br>    redisTemplate.delete(id.toString());<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Qï¼š<u>ä¸ºä»€ä¹ˆä½¿ç”¨clearï¼Œä¸æ ¹æ®æŒ‡å®šçš„keyåˆ é™¤å¯¹åº”çš„value</u><br>Aï¼š<img src="/Resources/Pasted%20image%2020220919204625.png" srcset="/img/loading.gif" lazyload><br><u>ç»è¿‡æµ‹è¯•ï¼Œä¸åŒå‚æ•°å¯¹åº”çš„Keyæ˜¯ä¸åŒçš„ï¼Œå› æ­¤åº”è¯¥æ˜¯å¯ä»¥é€šè¿‡åªåˆ é™¤å¯¹åº”çš„valueçš„ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨removeObjectæ–¹æ³•ï¼Œä½†æ˜¯mybatisé»˜è®¤å´æ²¡æœ‰å®ç°</u></p>
<h5 id="å®ç°getSize"><a href="#å®ç°getSize" class="headerlink" title="å®ç°getSize"></a>å®ç°getSize</h5><p>è¯¥æ–¹æ³•ç”¨äºè®¡ç®—ç¼“å­˜æ•°é‡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getSize</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     * é€šè¿‡applicationå·¥å…·ç±»è·å–redisTemplate</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">RedisTemplate</span> <span class="hljs-variable">redisTemplate</span> <span class="hljs-operator">=</span> (RedisTemplate) ApplicationContextUtils.getBean(<span class="hljs-string">&quot;redisTemplate&quot;</span>);<br>    redisTemplate.setKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br>    redisTemplate.setHashKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br><br>    <span class="hljs-keyword">return</span> redisTemplate.opsForHash().size(id.toString()).intValue();<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="æœ€åä¸€ç‚¹ï¼šä¼˜åŒ–è·å–redisTemplate"><a href="#æœ€åä¸€ç‚¹ï¼šä¼˜åŒ–è·å–redisTemplate" class="headerlink" title="æœ€åä¸€ç‚¹ï¼šä¼˜åŒ–è·å–redisTemplate"></a>æœ€åä¸€ç‚¹ï¼šä¼˜åŒ–è·å–redisTemplate</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> RedisTemplate <span class="hljs-title function_">getRedisTemplate</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">RedisTemplate</span> <span class="hljs-variable">redisTemplate</span> <span class="hljs-operator">=</span> (RedisTemplate) ApplicationContextUtils.getBean(<span class="hljs-string">&quot;redisTemplate&quot;</span>);<br>    redisTemplate.setKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br>    redisTemplate.setHashKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br>    <span class="hljs-keyword">return</span> redisTemplate;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆäºŒï¼‰"><a href="#åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆäºŒï¼‰" class="headerlink" title="åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆäºŒï¼‰"></a>åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆäºŒï¼‰</h3><p>å¦‚æœé¡¹ç›®ä¸­è¡¨æŸ¥è¯¢ä¹‹é—´æ²¡æœ‰ä»»ä½•å…³è”æŸ¥è¯¢ï¼Œä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸€ï¼‰ä¸­çš„ç¼“å­˜æ–¹å¼æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚</p>
<p><strong>ä½†æ˜¯å¦‚æœåœ¨è¡¨è¿æ¥æŸ¥è¯¢è¿‡ç¨‹ä¸­å°±ä¼šå­˜åœ¨ä¸€å®šçš„é—®é¢˜ï¼</strong></p>
<p>è§£å†³æ–¹å¼ï¼šå°†<code>&lt;cache&gt;</code>æ ‡ç­¾æ¢æˆ&#96;<cache-ref namespace="xxxx"/><br>æ•ˆæœå¦‚å›¾æ‰€ç¤ºï¼š<strong>UserDaoå’ŒEmpDaoå…±äº«UserDaoçš„ç¼“å­˜</strong>ï¼Œå³EmpDaoä½¿ç”¨äº†UserDaoçš„idï¼ˆnamespaceï¼‰è¿›è¡Œå­˜å‚¨ã€‚<br><img src="/Resources/Pasted%20image%2020220920200751.png" srcset="/img/loading.gif" lazyload></p>
<p>æµ‹è¯•<br><img src="/Resources/Pasted%20image%2020220920203940.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸‰ï¼‰"><a href="#åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸‰ï¼‰" class="headerlink" title="åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸‰ï¼‰"></a>åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆä¸‰ï¼‰</h3><ol>
<li>ç¼“å­˜ä¼˜åŒ–ç­–ç•¥<br>å¯¹æ”¾å…¥redisä¸­çš„keyï¼ˆè¿™é‡Œçš„keyæŒ‡çš„æ˜¯hashkeyï¼ŒçœŸæ­£çš„keyæ˜¯namespaceï¼‰çš„é•¿åº¦è¿›è¡Œä¼˜åŒ–ï¼šå°½å¯èƒ½çš„å°†keyè®¾è®¡ç®€æ´<br><img src="/Resources/Pasted%20image%2020220920202718.png" srcset="/img/loading.gif" lazyload><br><strong>ä½¿ç”¨MD5å¯¹keyè¿›è¡Œå¤„ç†</strong><br>MD5ç›¸å…³å‚è€ƒï¼š<a href="../../Shiro/Shiro%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B.md#6%20%E4%BD%BF%E7%94%A8MD5%20Salt%20Hash">ä½¿ç”¨MD5 Salt Hash</a></li>
</ol>
<p>ä¿®æ”¹<code>RedisCache</code>ä¸­çš„ä»£ç <br><img src="/Resources/Pasted%20image%2020220920205128.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å°†å†—é•¿çš„keyè½¬ä¸ºmd5</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> md5</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> String <span class="hljs-title function_">getKeyToMd5</span><span class="hljs-params">(String key)</span>&#123;<br>    <span class="hljs-keyword">return</span> DigestUtils.md5DigestAsHex(key.getBytes());<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä¿®æ”¹ä¹‹åå¦‚ä¸‹æ‰€ç¤º</p>
<ul>
<li>æ”¾<br><img src="/Resources/Pasted%20image%2020220920205226.png" srcset="/img/loading.gif" lazyload></li>
<li>å–<br><img src="/Resources/Pasted%20image%2020220920205506.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<h3 id="ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ã€ç¼“å­˜å‡»ç©¿"><a href="#ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ã€ç¼“å­˜å‡»ç©¿" class="headerlink" title="ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ã€ç¼“å­˜å‡»ç©¿"></a>ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ã€ç¼“å­˜å‡»ç©¿</h3><blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45637260/article/details/125866738">è¯¦è§£ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©ã€ç¼“å­˜å‡»ç©¿</a></p>
</blockquote>
<h4 id="ç¼“å­˜ç©¿é€"><a href="#ç¼“å­˜ç©¿é€" class="headerlink" title="ç¼“å­˜ç©¿é€"></a>ç¼“å­˜ç©¿é€</h4><p>å¤§å¤šæ•°æƒ…å†µï¼Œç¼“å­˜å¯ä»¥å‡å°‘æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<p>é€šå¸¸æµç¨‹æ˜¯ï¼šä¸€ä¸ªè¯·æ±‚è¿‡æ¥ï¼Œå…ˆæŸ¥è¯¢æ˜¯å¦åœ¨ç¼“å­˜å½“ä¸­ï¼Œå¦‚æœç¼“å­˜ä¸­å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚å¦‚æœç¼“å­˜ä¸­ä¸å­˜åœ¨å¯¹åº”çš„æ•°æ®ï¼Œåˆ™æ£€ç´¢æ•°æ®åº“ï¼Œå¦‚æœæ•°æ®åº“ä¸­å­˜åœ¨å¯¹åº”çš„æ•°æ®ï¼Œåˆ™æ›´æ–°ç¼“å­˜å¹¶è¿”å›ç»“æœã€‚å¦‚æœæ•°æ®åº“ä¸­ä¹Ÿä¸å­˜åœ¨å¯¹åº”çš„æ•°æ®ï¼Œåˆ™è¿”å›ç©ºæˆ–é”™è¯¯ã€‚</p>
<p>ç¼“å­˜ç©¿é€ï¼ˆcache penetrationï¼‰æ˜¯ç”¨æˆ·è®¿é—®çš„<strong>æ•°æ®æ—¢ä¸åœ¨ç¼“å­˜å½“ä¸­ï¼Œä¹Ÿä¸åœ¨æ•°æ®åº“ä¸­</strong>ã€‚å‡ºäºå®¹é”™çš„è€ƒè™‘ï¼Œå¦‚æœä»åº•å±‚æ•°æ®åº“æŸ¥è¯¢ä¸åˆ°æ•°æ®ï¼Œåˆ™ä¸å†™å…¥ç¼“å­˜ã€‚è¿™å°±å¯¼è‡´<strong>æ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ°åº•å±‚æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼Œç¼“å­˜ä¹Ÿå¤±å»äº†æ„ä¹‰</strong>ã€‚å½“é«˜å¹¶å‘æˆ–æœ‰äººåˆ©ç”¨ä¸å­˜åœ¨çš„Keyé¢‘ç¹æ”»å‡»æ—¶ï¼Œ<strong>æ•°æ®åº“çš„å‹åŠ›éª¤å¢</strong>ï¼Œç”šè‡³å´©æºƒï¼Œè¿™å°±æ˜¯<strong>ç¼“å­˜ç©¿é€</strong>é—®é¢˜ã€‚<br><img src="/Resources/Pasted%20image%2020230531111802.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li><p>è§£å†³æ–¹æ¡ˆ1ï¼šç¼“å­˜ç©ºæ•°æ®ï¼ŒæŸ¥è¯¢è¿”å›çš„æ•°æ®ä¸ºç©ºï¼Œä»æŠŠè¿™ä¸ªç©ºç»“æœè¿›è¡Œç¼“å­˜ï¼Œæ­¤æ—¶å¦‚æœå¾€æ•°æ®åº“æ’å…¥äº†æ•°æ®ï¼Œéœ€è¦æŠŠredisä¸­çš„æ•°æ®è¿›è¡Œæ›´æ–°</p>
<ul>
<li>è¿”å›å€¼ï¼š<code>&#123;key : 1, value : null&#125;</code></li>
<li>æ›´æ–°å€¼ï¼š<code>&#123;key : 1, value : 1&#125;</code></li>
<li>ç¼ºç‚¹ï¼šå¯èƒ½å­˜åœ¨æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œæ²¡æœ‰åŠæ—¶æ›´æ–°ï¼Œå¯¼è‡´æ•°æ®åº“å·²ç»æœ‰ç»“æœäº†ï¼Œä½†æ˜¯redisä¸­è¿˜æ˜¯null</li>
</ul>
</li>
<li><p>è§£å†³æ–¹æ¡ˆ2ï¼š<strong>å¸ƒéš†è¿‡æ»¤å™¨</strong></p>
<ul>
<li><img src="/Resources/Pasted%20image%2020230531111852.png" srcset="/img/loading.gif" lazyload></li>
<li>å®ç°æ–¹æ¡ˆ<ul>
<li>Redissonï¼šå®ƒçš„åº•å±‚ä¸»è¦æ˜¯å…ˆå»åˆå§‹åŒ–ä¸€ä¸ªæ¯”è¾ƒå¤§æ•°ç»„ï¼Œé‡Œé¢å­˜æ”¾çš„äºŒè¿›åˆ¶0æˆ–1ã€‚åœ¨ä¸€å¼€å§‹éƒ½æ˜¯0ï¼Œå½“ä¸€ä¸ªkeyæ¥äº†ä¹‹åç»è¿‡3æ¬¡hashè®¡ç®—ï¼Œæ¨¡äºæ•°ç»„é•¿åº¦æ‰¾åˆ°æ•°æ®çš„ä¸‹æ ‡ç„¶åæŠŠæ•°ç»„ä¸­åŸæ¥çš„0æ”¹ä¸º1ï¼Œè¿™æ ·çš„è¯ï¼Œä¸‰ä¸ªæ•°ç»„çš„ä½ç½®å°±èƒ½æ ‡æ˜ä¸€ä¸ªkeyçš„å­˜åœ¨ã€‚æŸ¥æ‰¾çš„è¿‡ç¨‹ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://github.com/redisson/redisson#quick-start">Javaå®ç°æ–¹æ³•å¦‚ä¸‹</a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>	<span class="hljs-type">Config</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Config</span>();<br>	config.useSingleServer().setAddress(<span class="hljs-string">&quot;redis://127.0.0.1:6379&quot;</span>);<br>	config.useSingleServer().setPassword(<span class="hljs-string">&quot;123&quot;</span>);<br>	<span class="hljs-comment">//æ„é€ Redisson</span><br>	<span class="hljs-type">RedissonClient</span> <span class="hljs-variable">redisson</span> <span class="hljs-operator">=</span> Redisson.create(config);<br> <br>	RBloomFilter&lt;String&gt; bloomFilter = redisson.getBloomFilter(<span class="hljs-string">&quot;phoneList&quot;</span>);<br>	<span class="hljs-comment">//åˆå§‹åŒ–å¸ƒéš†è¿‡æ»¤å™¨ï¼šé¢„è®¡å…ƒç´ ä¸º100000000L,è¯¯å·®ç‡ä¸º3%</span><br>	bloomFilter.tryInit(<span class="hljs-number">100000000L</span>,<span class="hljs-number">0.03</span>);<br>	<span class="hljs-comment">//å°†å·ç 10086æ’å…¥åˆ°å¸ƒéš†è¿‡æ»¤å™¨ä¸­</span><br>	bloomFilter.add(<span class="hljs-string">&quot;10086&quot;</span>);<br> <br>	<span class="hljs-comment">//åˆ¤æ–­ä¸‹é¢å·ç æ˜¯å¦åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­</span><br>	System.out.println(bloomFilter.contains(<span class="hljs-string">&quot;123456&quot;</span>));<span class="hljs-comment">//false</span><br>	System.out.println(bloomFilter.contains(<span class="hljs-string">&quot;10086&quot;</span>));<span class="hljs-comment">//true</span><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>Guava</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼šå¸ƒéš†è¿‡æ»¤å™¨æ˜¯é€šè¿‡æŸ¥è¯¢hashåçš„å€¼æ˜¯å¦ä¸º1ï¼Œå½“id1å’Œid2å°†1ã€3ã€7ã€9ã€12ã€14çš„å€¼æ›´æ”¹ä¸º1åï¼Œid3å¯¹åº”çš„3ã€9ã€12æ°å¥½ä¹Ÿä¸º1ï¼Œä½†å®é™…ä¸Šid3æ˜¯ä¸å­˜åœ¨çš„<ul>
<li><img src="/Resources/Pasted%20image%2020230531113240.png" srcset="/img/loading.gif" lazyload></li>
<li>å­˜åœ¨è¯¯åˆ¤</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h4><p>åœ¨ä½¿ç”¨ç¼“å­˜æ—¶ï¼Œé€šå¸¸ä¼šå¯¹ç¼“å­˜è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¸€æ–¹é¢ç›®çš„æ˜¯ä¿æŒç¼“å­˜ä¸æ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¦ä¸€æ–¹é¢æ˜¯å‡å°‘å†·ç¼“å­˜å ç”¨è¿‡å¤šçš„å†…å­˜ç©ºé—´ã€‚</p>
<p>ä½†å½“ç¼“å­˜ä¸­å¤§é‡çƒ­ç‚¹ç¼“å­˜é‡‡ç”¨äº†ç›¸åŒçš„å®æ•ˆæ—¶é—´ï¼Œå°±ä¼šå¯¼è‡´<strong>å¤§é‡ç¼“å­˜åœ¨æŸä¸€ä¸ªæ—¶åˆ»åŒæ—¶å®æ•ˆ</strong>ï¼Œè¯·æ±‚å…¨éƒ¨è½¬å‘åˆ°æ•°æ®åº“ï¼Œä»è€Œå¯¼è‡´<strong>æ•°æ®åº“å‹åŠ›éª¤å¢</strong>ï¼Œç”šè‡³å®•æœºã€‚ä»è€Œå½¢æˆä¸€ç³»åˆ—çš„è¿é”ååº”ï¼Œé€ æˆç³»ç»Ÿå´©æºƒç­‰æƒ…å†µï¼Œè¿™å°±æ˜¯<strong>ç¼“å­˜é›ªå´©</strong>ï¼ˆCache Avalancheï¼‰ã€‚</p>
<p><img src="/Resources/Pasted%20image%2020230531145859.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>è§£å†³æ–¹æ¡ˆï¼š<ul>
<li>ç»™ä¸åŒçš„Keyçš„TTLæ·»åŠ éšæœºå€¼</li>
<li>åˆ©ç”¨Redisé›†ç¾¤æé«˜æœåŠ¡çš„å¯ç”¨æ€§ï¼šå“¨å…µæ¨¡å¼ã€é›†ç¾¤æ¨¡å¼</li>
<li>ç»™ç¼“å­˜ä¸šåŠ¡æ·»åŠ é™çº§é™æµç­–ç•¥<ul>
<li>ngxinã€spring cloud gateway</li>
<li>é™çº§å¯åšä¸ºç³»ç»Ÿçš„ä¿åº•ç­–ç•¥ï¼Œé€‚ç”¨äºç©¿é€ã€å‡»ç©¿ã€é›ªå´©</li>
</ul>
</li>
<li>ç»™ä¸šåŠ¡æ·»åŠ å¤šçº§ç¼“å­˜ï¼šGuavaã€Caffeine</li>
</ul>
</li>
</ul>
<h4 id="ç¼“å­˜å‡»ç©¿"><a href="#ç¼“å­˜å‡»ç©¿" class="headerlink" title="ç¼“å­˜å‡»ç©¿"></a>ç¼“å­˜å‡»ç©¿</h4><p>ç¼“å­˜é›ªå´©æ˜¯æŒ‡å¤§é‡çƒ­ç‚¹keyåŒæ—¶å¤±æ•ˆçš„æƒ…å†µï¼Œå¦‚æœæ˜¯<strong>å•ä¸ªçƒ­ç‚¹key</strong>ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œåœ¨è¿™ä¸ªkeyå¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘è¯·æ±‚å°±ä¼šå‡»ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚åˆ°æ•°æ®åº“ï¼Œå¥½åƒè›®åŠ›å‡»ç©¿ä¸€æ ·ã€‚è¿™ç§æƒ…å†µå°±æ˜¯<strong>ç¼“å­˜å‡»ç©¿</strong>ï¼ˆCache Breakdownï¼‰ã€‚</p>
<p><img src="/Resources/Pasted%20image%2020230531143625.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>è§£å†³æ–¹æ¡ˆ1ï¼šäº’æ–¥é”(<strong>å¼ºä¸€è‡´</strong>)</li>
<li>è§£å†³æ–¹æ¡ˆ2ï¼šé€»è¾‘è¿‡æœŸ(<strong>é«˜å¯ç”¨</strong>)</li>
<li><img src="/Resources/Pasted%20image%2020230531144701.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<p>ä»å®šä¹‰ä¸Šå¯ä»¥çœ‹å‡ºï¼Œç¼“å­˜å‡»ç©¿å’Œç¼“å­˜é›ªå´©å¾ˆç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯ç¼“å­˜å‡»ç©¿æ˜¯ä¸€ä¸ªçƒ­ç‚¹keyå¤±æ•ˆï¼Œè€Œç¼“å­˜é›ªå´©æ˜¯å¤§é‡çƒ­ç‚¹keyå¤±æ•ˆã€‚å› æ­¤ï¼Œå¯ä»¥å°†ç¼“å­˜å‡»ç©¿çœ‹ä½œæ˜¯ç¼“å­˜é›ªå´©çš„ä¸€ä¸ªå­é›†ã€‚</p>
<h2 id="13ã€Redisä¸»ä»"><a href="#13ã€Redisä¸»ä»" class="headerlink" title="13ã€Redisä¸»ä»"></a>13ã€Redisä¸»ä»</h2><h3 id="ä¸»ä»æ¶æ„"><a href="#ä¸»ä»æ¶æ„" class="headerlink" title="ä¸»ä»æ¶æ„"></a>ä¸»ä»æ¶æ„</h3><p>å•èŠ‚ç‚¹Redisçš„å¹¶å‘èƒ½åŠ›æ˜¯æœ‰ä¸Šé™çš„ï¼Œè¦è¿›ä¸€æ­¥æé«˜Redisçš„å¹¶å‘èƒ½åŠ›ï¼Œå°±éœ€è¦æ­å»ºä¸»ä»é›†ç¾¤ï¼Œå®ç°è¯»å†™åˆ†ç¦»ã€‚å› ä¸ºæ ¹æ®ç»éªŒï¼Œå¯¹Redisçš„æ“ä½œå¤§éƒ¨åˆ†éƒ½æ˜¯è¯»ï¼Œå†™æ“ä½œå å°‘æ•°ï¼Œæ‰€ä»¥åœ¨é›†ç¾¤ä¸­é‡‡ç”¨è¯»å†™åˆ†ç¦»ï¼ŒåŒæ—¶ä»¥å°‘é‡ä¸»èŠ‚ç‚¹å’Œå¤§é‡ä»èŠ‚ç‚¹æ­é…ï¼Œå¤§å¤§æå‡Redisçš„è¯»å–æ€§èƒ½ã€‚<strong>ä¸»èŠ‚ç‚¹éœ€è¦æ³¨æ„çš„å°±æ˜¯æ•°æ®åŒæ­¥å¦‚ä½•åŒæ­¥ç»™ä»èŠ‚ç‚¹ã€‚</strong></p>
<h3 id="ä¸»ä»æ¶æ„å›¾"><a href="#ä¸»ä»æ¶æ„å›¾" class="headerlink" title="ä¸»ä»æ¶æ„å›¾"></a>ä¸»ä»æ¶æ„å›¾</h3><p><img src="/Resources/Pasted%20image%2020230601142227.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="æ­å»ºä¸»ä»æ¶æ„"><a href="#æ­å»ºä¸»ä»æ¶æ„" class="headerlink" title="æ­å»ºä¸»ä»æ¶æ„"></a>æ­å»ºä¸»ä»æ¶æ„</h3><p>ä½¿ç”¨dockeræ­å»ºredisä¸»ä»æ¶æ„<br>å‚è€ƒï¼š<a href="../../../Develop/%E5%BC%80%E5%8F%91%E8%99%9A%E6%8B%9F%E6%9C%BA/Docker%20%E5%AE%89%E8%A3%85%E5%AE%B9%E5%99%A8%E5%90%88%E9%9B%86.md#1%20Master%20Slave">docker æ­å»ºredisä¸»ä»æ¶æ„</a></p>
<p><strong>ä¸»ä»å¤åˆ¶åŒæ­¥åŸç†</strong></p>
<ul>
<li>ä¸»ä»å…¨é‡åŒæ­¥<ul>
<li>Replication Idï¼šç®€ç§°replidï¼Œæ˜¯æ•°æ®é›†çš„æ ‡è®°ï¼Œidä¸€è‡´åˆ™è¯´æ˜æ˜¯åŒä¸€æ•°æ®é›†ã€‚æ¯ä¸€ä¸ªmasteréƒ½æœ‰å”¯ä¸€çš„replidï¼Œslaveåˆ™ä¼šç»§æ‰¿masterèŠ‚ç‚¹çš„replid</li>
<li>offsetï¼šåç§»é‡ï¼Œéšç€è®°å½•åœ¨repl_baklogä¸­çš„æ•°æ®å¢å¤šè€Œé€æ¸å¢å¤§ã€‚slaveå®ŒæˆåŒæ­¥æ—¶ä¹Ÿä¼šè®°å½•å½“å‰åŒæ­¥çš„offsetã€‚å¦‚æœslaveçš„offsetå°äºmasterçš„offsetï¼Œè¯´æ˜slaveæ•°æ®è½åäºmasterï¼Œéœ€è¦æ›´æ–°ã€‚</li>
<li><img src="/Resources/Pasted%20image%2020230601143233.png" srcset="/img/loading.gif" lazyload></li>
</ul>
</li>
<li>ä¸»ä»å¢é‡åŒæ­¥<ul>
<li><img src="/Resources/Pasted%20image%2020230601143341.png" srcset="/img/loading.gif" lazyload></li>
<li><img src="/Resources/Pasted%20image%2020230601143359.png" srcset="/img/loading.gif" lazyload></li>
</ul>
</li>
</ul>
<h2 id="14ã€Rediså“¨å…µæœºåˆ¶"><a href="#14ã€Rediså“¨å…µæœºåˆ¶" class="headerlink" title="14ã€Rediså“¨å…µæœºåˆ¶"></a>14ã€Rediså“¨å…µæœºåˆ¶</h2><h3 id="å“¨å…µSentinelæœºåˆ¶"><a href="#å“¨å…µSentinelæœºåˆ¶" class="headerlink" title="å“¨å…µSentinelæœºåˆ¶"></a>å“¨å…µSentinelæœºåˆ¶</h3><p>Sentinelï¼ˆå“¨å…µï¼‰æ˜¯Redisçš„é«˜å¯ç”¨æ€§è§£å†³æ–¹æ¡ˆï¼šç”±ä¸€ä¸ªæˆ–å¤šä¸ªSentinelå®ä¾‹ç»„æˆçš„Sentinelç³»ç»Ÿï¼Œå®ƒå¯ä»¥ç›‘è§†ä»»æ„å¤šä¸ªä¸»æœåŠ¡å™¨ï¼Œä»¥åŠè¿™äº›ä¸»æœåŠ¡å™¨å±ä¸‹çš„æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œå¹¶åœ¨è¢«ç›‘è§†çš„ä¸»æœåŠ¡å™¨è¿›å…¥ä¸‹çº¿çŠ¶æ€æ—¶ï¼Œè‡ªåŠ¨å°†ä¸‹çº¿ä¸»æœåŠ¡å™¨å±ä¸‹çš„æŸä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚ç®€å•çš„è¯´<strong>å“¨å…µå°±æ˜¯å¸¦æœ‰è‡ªåŠ¨æ•…éšœè½¬ç§»åŠŸèƒ½çš„ä¸»ä»æ¶æ„</strong>ã€‚<br><img src="/Resources/Pasted%20image%2020230605095101.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>å“¨å…µæ¶æ„åŸç†</strong><br><img src="/Resources/Pasted%20image%2020220921164320.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>å¦‚æœæœ€åçš„masterè¢«ä¿®å¤äº†ä¹‹åï¼Œå°†æˆä¸ºæ–°çš„slaveèŠ‚ç‚¹ç»§ç»­åŠ å…¥redisé›†ç¾¤ï¼ˆSentinelç³»ç»Ÿï¼‰ä¸­ã€‚</p>
</blockquote>
<p><strong>å“¨å…µç›‘æ§æœºåˆ¶</strong><br><img src="/Resources/Pasted%20image%2020220921195400.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="å“¨å…µè„‘è£‚"><a href="#å“¨å…µè„‘è£‚" class="headerlink" title="å“¨å…µè„‘è£‚"></a>å“¨å…µè„‘è£‚</h3><p>é›†ç¾¤è„‘è£‚æ˜¯ç”±äºä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹å’Œsentinelå¤„äºä¸åŒçš„ç½‘ç»œåˆ†åŒºï¼Œä½¿å¾—sentinelæ²¡æœ‰èƒ½å¤Ÿå¿ƒè·³æ„ŸçŸ¥åˆ°ä¸»èŠ‚ç‚¹ï¼Œæ‰€ä»¥é€šè¿‡é€‰ä¸¾çš„æ–¹å¼æå‡äº†ä¸€ä¸ªä»èŠ‚ç‚¹ä¸ºä¸»ï¼Œè¿™æ ·å°±å­˜åœ¨äº†ä¸¤ä¸ªmasterï¼Œå°±åƒå¤§è„‘åˆ†è£‚äº†ä¸€æ ·ï¼Œè¿™æ ·ä¼šå¯¼è‡´å®¢æˆ·ç«¯è¿˜åœ¨è€çš„ä¸»èŠ‚ç‚¹é‚£é‡Œå†™å…¥æ•°æ®ï¼Œæ–°èŠ‚ç‚¹æ— æ³•åŒæ­¥æ•°æ®ï¼Œå½“ç½‘ç»œæ¢å¤åï¼Œsentinelä¼šå°†è€çš„ä¸»èŠ‚ç‚¹é™ä¸ºä»èŠ‚ç‚¹ï¼Œè¿™æ—¶å†ä»æ–°masteråŒæ­¥æ•°æ®ï¼Œå°±ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±</p>
<p><img src="/Resources/Pasted%20image%2020230605100402.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/Resources/Pasted%20image%2020230605100349.png" srcset="/img/loading.gif" lazyload><br>è§£å†³åŠæ³•ï¼šæˆ‘ä»¬å¯ä»¥ä¿®æ”¹redisçš„é…ç½®ï¼Œå¯ä»¥è®¾ç½®æœ€å°‘çš„ä»èŠ‚ç‚¹æ•°é‡ä»¥åŠç¼©çŸ­ä¸»ä»æ•°æ®åŒæ­¥çš„å»¶è¿Ÿæ—¶é—´ï¼Œè¾¾ä¸åˆ°è¦æ±‚å°±æ‹’ç»è¯·æ±‚ï¼Œå°±å¯ä»¥é¿å…å¤§é‡çš„æ•°æ®ä¸¢å¤±</p>
<p>redisä¸­æœ‰ä¸¤ä¸ªé…ç½®å‚æ•°ï¼š</p>
<p>min-replicas-to-write 1Â Â  è¡¨ç¤ºæœ€å°‘çš„salveèŠ‚ç‚¹ä¸º1ä¸ª</p>
<p>min-replicas-max-lag 5Â  è¡¨ç¤ºæ•°æ®å¤åˆ¶å’ŒåŒæ­¥çš„å»¶è¿Ÿä¸èƒ½è¶…è¿‡5ç§’</p>
<h3 id="æ­å»ºå“¨å…µæ¶æ„"><a href="#æ­å»ºå“¨å…µæ¶æ„" class="headerlink" title="æ­å»ºå“¨å…µæ¶æ„"></a>æ­å»ºå“¨å…µæ¶æ„</h3><p>å‚è€ƒï¼š<a href="../../../Develop/%E5%BC%80%E5%8F%91%E8%99%9A%E6%8B%9F%E6%9C%BA/Docker%20%E5%AE%89%E8%A3%85%E5%AE%B9%E5%99%A8%E5%90%88%E9%9B%86.md#2%20Redis%20Sentinel">2 Redis Sentinel</a></p>
<h3 id="Springbootæ“ä½œå“¨å…µæœºåˆ¶ä¸‹çš„Redis"><a href="#Springbootæ“ä½œå“¨å…µæœºåˆ¶ä¸‹çš„Redis" class="headerlink" title="Springbootæ“ä½œå“¨å…µæœºåˆ¶ä¸‹çš„Redis"></a>Springbootæ“ä½œå“¨å…µæœºåˆ¶ä¸‹çš„Redis</h3><blockquote>
<p>ä¸»ä»å¤åˆ¶æ¨¡å¼ä¸‹çš„åªéœ€è¦åŠ ä¸€ä¸ªå¯†ç å°±å¯ä»¥äº†ï¼Œå…¶ä»–éƒ½ä¸éœ€è¦æ›´æ”¹ï¼</p>
</blockquote>
<h4 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8989</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-comment">#  å•èŠ‚ç‚¹</span><br>  <span class="hljs-comment">#  redis:</span><br>  <span class="hljs-comment">#    host: 192.168.153.135</span><br>  <span class="hljs-comment">#    password: redispwd</span><br>  <span class="hljs-comment">#  redis sentinelé…ç½®</span><br>  <span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-string">redispwd</span><br>    <span class="hljs-attr">sentinel:</span><br>      <span class="hljs-comment"># masteræ˜¯ä½¿ç”¨å“¨å…µç›‘å¬çš„é‚£ä¸ªåç§°</span><br>      <span class="hljs-attr">master:</span> <span class="hljs-string">mymaster</span><br>      <span class="hljs-comment"># è¿æ¥çš„ä¸å†æ˜¯ä¸€ä¸ªå…·ä½“redisä¸»æœº,å†™çš„æ˜¯å¤šä¸ªå“¨å…µèŠ‚ç‚¹</span><br>      <span class="hljs-attr">nodes:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-number">192.168</span><span class="hljs-number">.153</span><span class="hljs-number">.135</span><span class="hljs-string">:26379</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-number">192.168</span><span class="hljs-number">.153</span><span class="hljs-number">.135</span><span class="hljs-string">:26380</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-number">192.168</span><span class="hljs-number">.153</span><span class="hljs-number">.135</span><span class="hljs-string">:26381</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">redispwd</span><br></code></pre></td></tr></table></figure>

<h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><ol>
<li><p>æ‰§è¡ŒæŸ¥è¯¢çš„å‘½ä»¤ï¼šä»æ•°æ®åº“æ‹¿æ•°æ®å¹¶ç¼“å­˜åˆ°redis<br><img src="/Resources/Pasted%20image%2020220922201818.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>æ­¤æ—¶åœæ‰masteræœåŠ¡å™¨</p>
</li>
<li><p>å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢çš„å‘½ä»¤ï¼š<br>æŠ¥é”™è¿ä¸ä¸Šredisï¼ˆæ­¤æ—¶è¿æ¥çš„æ˜¯æ–°çš„masteræ‰¾ä¸åˆ°ï¼‰<br><img src="/Resources/Pasted%20image%2020220923091850.png" srcset="/img/loading.gif" lazyload><br>æš‚æ—¶ä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼Œå¯è§†åŒ–å·¥å…·æ˜¯å¯ä»¥å®ç°ä¸»èŠ‚ç‚¹å®•æœºï¼Œä»èŠ‚ç‚¹å˜æˆä¸»èŠ‚ç‚¹ï¼Œå¹¶èƒ½å¤Ÿå®ç°ä¸»ä»å¤åˆ¶ï¼Œè¿™é‡Œå¯èƒ½æ˜¯é…ç½®æ–‡ä»¶å†™é”™äº†ï¼Œå¯¼è‡´å‡ºé—®é¢˜ï¼Œä¹‹åå†è§£å†³</p>
</li>
</ol>
<h2 id="15ã€Redisé›†ç¾¤"><a href="#15ã€Redisé›†ç¾¤" class="headerlink" title="15ã€Redisé›†ç¾¤"></a>15ã€Redisé›†ç¾¤</h2><p>Redisåœ¨3.0åå¼€å§‹æ”¯æŒClusterï¼ˆæ¨¡å¼ï¼‰æ¨¡å¼ï¼Œç›®å‰redisçš„é›†ç¾¤æ”¯æŒèŠ‚ç‚¹çš„è‡ªåŠ¨å‘ç°ï¼Œæ”¯æŒslave-masteré€‰ä¸¾å’Œå®¹é”™ï¼Œæ”¯æŒåœ¨çº¿åˆ†ç‰‡(sharding shard )ç­‰ç‰¹æ€§ã€‚</p>
<h2 id="16ã€åŒå†™ä¸€è‡´"><a href="#16ã€åŒå†™ä¸€è‡´" class="headerlink" title="16ã€åŒå†™ä¸€è‡´"></a>16ã€åŒå†™ä¸€è‡´</h2><p>åŒå†™ä¸€è‡´æ€§ï¼šå½“ä¿®æ”¹äº†æ•°æ®åº“çš„æ•°æ®ä¹Ÿè¦åŒæ—¶æ›´æ–°ç¼“å­˜çš„æ•°æ®ï¼Œç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®è¦ä¿æŒä¸€è‡´</p>
<h3 id="ä¸€è‡´æ€§è¦æ±‚é«˜"><a href="#ä¸€è‡´æ€§è¦æ±‚é«˜" class="headerlink" title="ä¸€è‡´æ€§è¦æ±‚é«˜"></a>ä¸€è‡´æ€§è¦æ±‚é«˜</h3><p>Redissonæä¾›çš„è¯»å†™é”</p>
<h3 id="å…è®¸å»¶è¿Ÿä¸€è‡´"><a href="#å…è®¸å»¶è¿Ÿä¸€è‡´" class="headerlink" title="å…è®¸å»¶è¿Ÿä¸€è‡´"></a>å…è®¸å»¶è¿Ÿä¸€è‡´</h3><p>å¼‚æ­¥é€šçŸ¥ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§</p>
<p>åŸºäºMQçš„å¼‚æ­¥é€šçŸ¥ï¼š<br><img src="/Resources/Pasted%20image%2020230531153915.png" srcset="/img/loading.gif" lazyload><br>åŸºäºCanalçš„å¼‚æ­¥é€šçŸ¥ï¼š<br><img src="/Resources/Pasted%20image%2020230531153939.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="17ã€æ•°æ®è¿‡æœŸç­–ç•¥"><a href="#17ã€æ•°æ®è¿‡æœŸç­–ç•¥" class="headerlink" title="17ã€æ•°æ®è¿‡æœŸç­–ç•¥"></a>17ã€æ•°æ®è¿‡æœŸç­–ç•¥</h2><p>Rediså¯¹æ•°æ®è®¾ç½®æ•°æ®çš„æœ‰æ•ˆæ—¶é—´ï¼Œæ•°æ®è¿‡æœŸä»¥åï¼Œå°±éœ€è¦å°†æ•°æ®ä»å†…å­˜ä¸­åˆ é™¤æ‰ã€‚å¯ä»¥æŒ‰ç…§ä¸åŒçš„è§„åˆ™è¿›è¡Œåˆ é™¤ï¼Œè¿™ç§åˆ é™¤è§„åˆ™å°±è¢«ç§°ä¹‹ä¸ºæ•°æ®çš„åˆ é™¤ç­–ç•¥ï¼ˆæ•°æ®è¿‡æœŸç­–ç•¥ï¼‰ã€‚</p>
<p>Redisçš„è¿‡æœŸåˆ é™¤ç­–ç•¥ï¼šæƒ°æ€§åˆ é™¤ + å®šæœŸåˆ é™¤ä¸¤ç§ç­–ç•¥è¿›è¡Œé…åˆä½¿ç”¨</p>
<ul>
<li>æƒ°æ€§åˆ é™¤<ul>
<li>è®¾ç½®è¯¥keyè¿‡æœŸæ—¶é—´åï¼Œæˆ‘ä»¬ä¸å»ç®¡å®ƒï¼Œå½“éœ€è¦è¯¥keyæ—¶ï¼Œæˆ‘ä»¬åœ¨æ£€æŸ¥å…¶æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸï¼Œæˆ‘ä»¬å°±åˆ æ‰å®ƒï¼Œåä¹‹è¿”å›è¯¥key</li>
<li>ä¼˜ç‚¹ ï¼šå¯¹CPUå‹å¥½ï¼Œåªä¼šåœ¨ä½¿ç”¨è¯¥keyæ—¶æ‰ä¼šè¿›è¡Œè¿‡æœŸæ£€æŸ¥ï¼Œå¯¹äºå¾ˆå¤šç”¨ä¸åˆ°çš„keyä¸ç”¨æµªè´¹æ—¶é—´è¿›è¡Œè¿‡æœŸæ£€æŸ¥</li>
<li>ç¼ºç‚¹ ï¼šå¯¹å†…å­˜ä¸å‹å¥½ï¼Œå¦‚æœä¸€ä¸ªkeyå·²ç»è¿‡æœŸï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰ä½¿ç”¨ï¼Œé‚£ä¹ˆè¯¥keyå°±ä¼šä¸€ç›´å­˜åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜æ°¸è¿œä¸ä¼šé‡Šæ”¾</li>
</ul>
</li>
<li>å®šæœŸåˆ é™¤<ul>
<li>æ¯éš”ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä»¬å°±å¯¹ä¸€äº›keyè¿›è¡Œæ£€æŸ¥ï¼Œåˆ é™¤é‡Œé¢è¿‡æœŸçš„key(ä»ä¸€å®šæ•°é‡çš„æ•°æ®åº“ä¸­å–å‡ºä¸€å®šæ•°é‡çš„éšæœºkeyè¿›è¡Œæ£€æŸ¥ï¼Œå¹¶åˆ é™¤å…¶ä¸­çš„è¿‡æœŸkey)ã€‚</li>
<li>ä¸¤ç§æ¨¡å¼ï¼š<ul>
<li>SLOWæ¨¡å¼æ˜¯å®šæ—¶ä»»åŠ¡ï¼Œæ‰§è¡Œé¢‘ç‡é»˜è®¤ä¸º10hzï¼Œæ¯æ¬¡ä¸è¶…è¿‡25msï¼Œä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶ <code>redis.conf</code> çš„ hz é€‰é¡¹æ¥è°ƒæ•´è¿™ä¸ªæ¬¡æ•°<br><img src="/Resources/Pasted%20image%2020230531172213.png" srcset="/img/loading.gif" lazyload></li>
<li>lFASTæ¨¡å¼æ‰§è¡Œé¢‘ç‡ä¸å›ºå®šï¼Œä½†ä¸¤æ¬¡é—´éš”ä¸ä½äº2msï¼Œæ¯æ¬¡è€—æ—¶ä¸è¶…è¿‡1ms</li>
</ul>
</li>
<li>ä¼˜ç‚¹ï¼šå¯ä»¥é€šè¿‡é™åˆ¶åˆ é™¤æ“ä½œæ‰§è¡Œçš„æ—¶é•¿å’Œé¢‘ç‡æ¥å‡å°‘åˆ é™¤æ“ä½œå¯¹ CPU çš„å½±å“ã€‚å¦å¤–å®šæœŸåˆ é™¤ï¼Œä¹Ÿèƒ½æœ‰æ•ˆé‡Šæ”¾è¿‡æœŸé”®å ç”¨çš„å†…å­˜ã€‚</li>
<li>ç¼ºç‚¹ï¼šéš¾ä»¥ç¡®å®šåˆ é™¤æ“ä½œæ‰§è¡Œçš„æ—¶é•¿å’Œé¢‘ç‡ã€‚</li>
</ul>
</li>
</ul>
<h2 id="18ã€æ•°æ®æ·˜æ±°ç­–ç•¥"><a href="#18ã€æ•°æ®æ·˜æ±°ç­–ç•¥" class="headerlink" title="18ã€æ•°æ®æ·˜æ±°ç­–ç•¥"></a>18ã€æ•°æ®æ·˜æ±°ç­–ç•¥</h2><p>æ•°æ®çš„æ·˜æ±°ç­–ç•¥ï¼šå½“Redisä¸­çš„å†…å­˜ä¸å¤Ÿç”¨æ—¶ï¼Œæ­¤æ—¶åœ¨å‘Redisä¸­æ·»åŠ æ–°çš„keyï¼Œé‚£ä¹ˆRediså°±ä¼šæŒ‰ç…§æŸä¸€ç§è§„åˆ™å°†å†…å­˜ä¸­çš„æ•°æ®åˆ é™¤æ‰ï¼Œè¿™ç§æ•°æ®çš„åˆ é™¤è§„åˆ™è¢«ç§°ä¹‹ä¸ºå†…å­˜çš„æ·˜æ±°ç­–ç•¥ã€‚</p>
<p><img src="/Resources/Pasted%20image%2020230531173256.png" srcset="/img/loading.gif" lazyload></p>
<p>Redisæ”¯æŒ8ç§ä¸åŒç­–ç•¥æ¥é€‰æ‹©è¦åˆ é™¤çš„keyï¼š</p>
<ul>
<li>noevictionï¼š ä¸æ·˜æ±°ä»»ä½•keyï¼Œä½†æ˜¯å†…å­˜æ»¡æ—¶ä¸å…è®¸å†™å…¥æ–°æ•°æ®ï¼Œ<strong>é»˜è®¤å°±æ˜¯è¿™ç§ç­–ç•¥</strong>ã€‚</li>
<li>volatile-ttlï¼š å¯¹è®¾ç½®äº†TTLçš„keyï¼Œæ¯”è¾ƒkeyçš„å‰©ä½™TTLå€¼ï¼ŒTTLè¶Šå°è¶Šå…ˆè¢«æ·˜æ±°</li>
<li>allkeys-randomï¼šå¯¹å…¨ä½“key ï¼Œéšæœºè¿›è¡Œæ·˜æ±°ã€‚</li>
<li>volatile-randomï¼šå¯¹è®¾ç½®äº†TTLçš„key ï¼Œéšæœºè¿›è¡Œæ·˜æ±°ã€‚</li>
<li>allkeys-lruï¼š å¯¹å…¨ä½“keyï¼ŒåŸºäºLRUç®—æ³•è¿›è¡Œæ·˜æ±°</li>
<li>volatile-lruï¼š å¯¹è®¾ç½®äº†TTLçš„keyï¼ŒåŸºäºLRUç®—æ³•è¿›è¡Œæ·˜æ±°</li>
<li>allkeys-lfuï¼š å¯¹å…¨ä½“keyï¼ŒåŸºäºLFUç®—æ³•è¿›è¡Œæ·˜æ±°</li>
<li>volatile-lfuï¼š å¯¹è®¾ç½®äº†TTLçš„keyï¼ŒåŸºäºLFUç®—æ³•è¿›è¡Œæ·˜æ±°</li>
</ul>
<p>LRUï¼ˆLeast <strong>Recently</strong> Usedï¼‰æœ€è¿‘æœ€å°‘ä½¿ç”¨ã€‚ç”¨å½“å‰æ—¶é—´å‡å»æœ€åä¸€æ¬¡è®¿é—®æ—¶é—´ï¼Œè¿™ä¸ªå€¼è¶Šå¤§åˆ™æ·˜æ±°ä¼˜å…ˆçº§è¶Šé«˜ã€‚</p>
<p>LFUï¼ˆLeast <strong>Frequently</strong> Usedï¼‰æœ€å°‘é¢‘ç‡ä½¿ç”¨ã€‚ä¼šç»Ÿè®¡æ¯ä¸ªkeyçš„è®¿é—®é¢‘ç‡ï¼Œå€¼è¶Šå°æ·˜æ±°ä¼˜å…ˆçº§è¶Šé«˜ã€‚</p>
<p>ä½¿ç”¨å»ºè®®ï¼š<br>1.ä¼˜å…ˆä½¿ç”¨ allkeys-lru ç­–ç•¥ã€‚å……åˆ†åˆ©ç”¨ LRU ç®—æ³•çš„ä¼˜åŠ¿ï¼ŒæŠŠæœ€è¿‘æœ€å¸¸è®¿é—®çš„æ•°æ®ç•™åœ¨ç¼“å­˜ä¸­ã€‚å¦‚æœä¸šåŠ¡æœ‰æ˜æ˜¾çš„å†·çƒ­æ•°æ®åŒºåˆ†ï¼Œå»ºè®®ä½¿ç”¨ã€‚</p>
<p>2.å¦‚æœä¸šåŠ¡ä¸­æ•°æ®è®¿é—®é¢‘ç‡å·®åˆ«ä¸å¤§ï¼Œæ²¡æœ‰æ˜æ˜¾å†·çƒ­æ•°æ®åŒºåˆ†ï¼Œå»ºè®®ä½¿ç”¨ allkeys-randomï¼Œéšæœºé€‰æ‹©æ·˜æ±°ã€‚</p>
<p>3.å¦‚æœä¸šåŠ¡ä¸­æœ‰ç½®é¡¶çš„éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ volatile-lru ç­–ç•¥ï¼ŒåŒæ—¶ç½®é¡¶æ•°æ®ä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿™äº›æ•°æ®å°±ä¸€ç›´ä¸è¢«åˆ é™¤ï¼Œä¼šæ·˜æ±°å…¶ä»–è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®ã€‚</p>
<p>4.å¦‚æœä¸šåŠ¡ä¸­æœ‰çŸ­æ—¶é«˜é¢‘è®¿é—®çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ allkeys-lfu æˆ– volatile-lfu ç­–ç•¥ã€‚</p>
<h2 id="19ã€åˆ†å¸ƒå¼é”"><a href="#19ã€åˆ†å¸ƒå¼é”" class="headerlink" title="19ã€åˆ†å¸ƒå¼é”"></a>19ã€åˆ†å¸ƒå¼é”</h2><p>åˆ†å¸ƒå¼é”ä½¿ç”¨çš„åœºæ™¯ï¼šé›†ç¾¤æƒ…å†µä¸‹çš„å®šæ—¶ä»»åŠ¡ã€æŠ¢å•ã€å¹‚ç­‰æ€§åœºæ™¯</p>
<p>æŠ¢åˆ¸åœºæ™¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æŠ¢è´­ä¼˜æƒ åˆ¸</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rushToPurchase</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>	<span class="hljs-comment">//è·å–ä¼˜æƒ åˆ¸æ•°é‡</span><br>	<span class="hljs-type">Integer</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> (Integer) redisTemplate.opsForValue().get(<span class="hljs-string">&quot;num&quot;</span>);<br>	<span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æŠ¢å®Œ</span><br>	<span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> == num || num &lt;= <span class="hljs-number">0</span>) &#123;<br>		<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;ä¼˜æƒ åˆ¸å·²æŠ¢å®Œ&quot;</span>);<br>	&#125;<br>	<span class="hljs-comment">//ä¼˜æƒ åˆ¸æ•°é‡å‡ä¸€ï¼Œè¯´æ˜æŠ¢åˆ°äº†ä¼˜æƒ åˆ¸</span><br>	num = num - <span class="hljs-number">1</span>;<br>	<span class="hljs-comment">// é‡æ–°è®¾ç½®ä¼˜æƒ åˆ¸çš„æ•°é‡</span><br>	redisTemplate.opsForValue().set(<span class="hljs-string">&quot;num&quot;</span>, num);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç ï¼Œä¼šå¯¼è‡´è¶…å–ç°è±¡ï¼Œå¦‚åº“å­˜ä¸º1çš„ä¼˜æƒ åˆ¸ï¼Œç»è¿‡ä¸¤ä¸ªçº¿ç¨‹çš„æ‰§è¡Œåï¼Œåº“å­˜å°±ä¼šå˜æˆ-1<br><img src="/Resources/Pasted%20image%2020230601095723.png" srcset="/img/loading.gif" lazyload></p>
<p>åŠ é”ï¼šä½¿ç”¨synchronizedå¯ä»¥è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œä½†è¿™ç§é”ï¼ˆæœ¬åœ°é”ï¼‰åªé€‚ç”¨äºå•ä½“åº”ç”¨ï¼Œåªèƒ½åœ¨å•ä¸ªjvmä¸­ç”Ÿæ•ˆ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æŠ¢è´­ä¼˜æƒ åˆ¸</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rushToPurchase</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>	<span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>		<span class="hljs-comment">//è·å–ä¼˜æƒ åˆ¸æ•°é‡</span><br>		<span class="hljs-type">Integer</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> (Integer) redisTemplate.opsForValue().get(<span class="hljs-string">&quot;num&quot;</span>);<br>		<span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æŠ¢å®Œ</span><br>		<span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> == num || num &lt;= <span class="hljs-number">0</span>) &#123;<br>			<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;ä¼˜æƒ åˆ¸å·²æŠ¢å®Œ&quot;</span>);<br>		&#125;<br>		<span class="hljs-comment">//ä¼˜æƒ åˆ¸æ•°é‡å‡ä¸€ï¼Œè¯´æ˜æŠ¢åˆ°äº†ä¼˜æƒ åˆ¸</span><br>		num = num - <span class="hljs-number">1</span>;<br>		<span class="hljs-comment">// é‡æ–°è®¾ç½®ä¼˜æƒ åˆ¸çš„æ•°é‡</span><br>		redisTemplate.opsForValue().set(<span class="hljs-string">&quot;num&quot;</span>, num);<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœä½¿ç”¨synchronizedï¼Œå¤šä¸ªtomcatä»»ç„¶ä¼šå‡ºç°è¶…å–é—®é¢˜</p>
<p><img src="/Resources/Pasted%20image%2020230601100459.png" srcset="/img/loading.gif" lazyload></p>
<p>åˆ†å¸ƒå¼é”<br><img src="/Resources/Pasted%20image%2020230601101303.png" srcset="/img/loading.gif" lazyload></p>
<p>å®ç°ï¼š<br>Rediså®ç°åˆ†å¸ƒå¼é”ä¸»è¦åˆ©ç”¨Redisçš„setnxå‘½ä»¤ã€‚setnxæ˜¯SET if not exists(å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ SET)çš„ç®€å†™ã€‚<br><img src="/Resources/Pasted%20image%2020230601102342.png" srcset="/img/loading.gif" lazyload><br>æ³¨æ„ï¼š<br>Q:å¦‚æœä¸è®¾ç½®æ—¶é—´ï¼Œå¯èƒ½ä¼šå› ä¸ºä¸šåŠ¡è¶…æ—¶æˆ–è€…æœåŠ¡å®•æœºå‡ºç°æ­»é”ï¼Œå› ä¸ºæ— æ³•é‡Šæ”¾é”<br>Q:å¦‚æœè®¾ç½®æ—¶é—´è¿‡çŸ­ï¼Œä¸šåŠ¡æ²¡æœ‰ç»“æŸå°±è¢«è‡ªåŠ¨åˆ é™¤äº†</p>
<p>A1:è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä½†å…·ä½“æ•°å€¼éœ€è¦æ ¹æ®å…·ä½“ä¸šåŠ¡è®¾ç½®<br>A2:ç»™é”ç»­æœŸï¼šä½¿ç”¨redissonå®ç°çš„åˆ†å¸ƒå¼é”</p>
<p>redissonå®ç°çš„åˆ†å¸ƒå¼é”:åŠ é”å’Œè®¾ç½®è¿‡æœŸæ—¶é—´æ˜¯åŸºäºluaè„šæœ¬ï¼ˆLuaè„šæœ¬æ˜¯rediså·²ç»å†…ç½®çš„ä¸€ç§è½»é‡å°å·§è¯­è¨€ï¼Œå…¶æ‰§è¡Œæ˜¯é€šè¿‡redisçš„<strong>eval</strong>Â &#x2F; <strong>evalsha</strong>Â å‘½ä»¤æ¥è¿è¡Œï¼ŒæŠŠæ“ä½œå°è£…æˆä¸€ä¸ªLuaè„šæœ¬ï¼Œ<del>å¦‚è®ºå¦‚ä½•éƒ½æ˜¯ä¸€æ¬¡æ‰§è¡Œçš„åŸå­æ“ä½œ</del>ï¼Œä¸è¿‡ï¼Œå¦‚æœ Lua è„šæœ¬è¿è¡Œæ—¶å‡ºé”™å¹¶ä¸­é€”ç»“æŸï¼Œå‡ºé”™ä¹‹åçš„å‘½ä»¤æ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ã€‚å¹¶ä¸”ï¼Œå‡ºé”™ä¹‹å‰æ‰§è¡Œçš„å‘½ä»¤æ˜¯æ— æ³•è¢«æ’¤é”€çš„ï¼Œæ— æ³•å®ç°ç±»ä¼¼å…³ç³»å‹æ•°æ®åº“æ‰§è¡Œå¤±è´¥å¯ä»¥å›æ»šçš„é‚£ç§åŸå­æ€§æ•ˆæœã€‚å³ï¼Œå¯ä»¥çœ‹ä½œæ˜¯åŸå­æ“ä½œï¼Œ<strong>ä½†ä¸¥æ ¼æ¥è¯´çš„è¯ï¼Œä¸å®Œå…¨æ»¡è¶³åŸå­æ€§ã€‚</strong>ï¼‰å®ç°çš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> RedissonClient redissonClient;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">redisLock</span><span class="hljs-params">()</span> &#123;<br>	<span class="hljs-comment">// è·å–é”ï¼ˆé‡å…¥é”ï¼‰ï¼Œæ‰§è¡Œé”çš„åç§°</span><br>	<span class="hljs-type">RLock</span> <span class="hljs-variable">rLock</span> <span class="hljs-operator">=</span> redissonClient.getLock(lockName);<br>	<span class="hljs-keyword">try</span> &#123;<br>		<span class="hljs-comment">// å°è¯•è·å–é”ï¼Œå‚æ•°åˆ†åˆ«æ˜¯:è·å–é”çš„æœ€å¤§ç­‰å¾…æ—¶é—´ï¼ˆæœŸé—´ä¼šé‡è¯•)ï¼Œé”è‡ªåŠ¨é‡Šæ”¾æ—¶é—´ï¼Œæ—¶é—´å•ä½</span><br>		<span class="hljs-comment">// boolean isLock = lock.tryLock(10ï¼Œ30ï¼ŒTimeUnit.SECONDS) ;</span><br>		<span class="hljs-type">boolean</span> <span class="hljs-variable">isLocked</span> <span class="hljs-operator">=</span> rLock.tryLock(expireTime, TimeUnit.MILLISECONDS);<br>		<span class="hljs-keyword">if</span> (isLocked) &#123;<br>			<span class="hljs-comment">// TODO</span><br>		&#125;<br>	&#125; <span class="hljs-keyword">finally</span> &#123;<br>		<span class="hljs-comment">// é‡Šæ”¾é”</span><br>		rLock.unlock();<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/Resources/Pasted%20image%2020230601103935.png" srcset="/img/loading.gif" lazyload></p>
<p>redissonå®ç°çš„åˆ†å¸ƒå¼é”-å¯é‡å…¥</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add1</span><span class="hljs-params">()</span> &#123;<br>	<span class="hljs-type">RLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> redissonClient.getLock(<span class="hljs-string">&quot;heimalock&quot;</span>);<br>	<span class="hljs-type">boolean</span> <span class="hljs-variable">isLock</span> <span class="hljs-operator">=</span> lock.tryLock();<br>	<span class="hljs-comment">//æ‰§è¡Œä¸šåŠ¡</span><br>	add2();<br>	<span class="hljs-comment">//é‡Šæ”¾é”</span><br>	lock.unlock();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add2</span><span class="hljs-params">()</span> &#123;<br>	<span class="hljs-type">RLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> redissonClient.getLock(<span class="hljs-string">&quot;heimalock&quot;</span>);<br>	<span class="hljs-type">boolean</span> <span class="hljs-variable">isLock</span> <span class="hljs-operator">=</span> lock.tryLock();<br>	<span class="hljs-comment">//æ‰§è¡Œä¸šåŠ¡</span><br>	<span class="hljs-comment">//é‡Šæ”¾é”</span><br>	lock.unlock();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œadd1åˆ›å»ºçš„é”ï¼Œadd2ä¹Ÿå¯ä»¥æ‹¿åˆ°ç»§ç»­ç”¨ï¼ˆå› ä¸ºæ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼‰ï¼Œå› ä¸ºredissonå®ç°çš„åˆ†å¸ƒå¼é”æ˜¯å¯é‡å…¥çš„ï¼Œåº•å±‚ç»´æŠ¤äº†hashç»“æ„ï¼Œå½“æ‰§è¡Œadd1çš„æ—¶å€™ï¼Œé‡å…¥æ¬¡æ•°ä¸º1<br><img src="/Resources/Pasted%20image%2020230601110132.png" srcset="/img/loading.gif" lazyload><br>å½“æ‰§è¡Œadd2çš„æ—¶å€™ï¼Œé‡å…¥æ¬¡æ•°ä¸º2<br>å½“æ‰§è¡Œå®Œæˆadd2çš„æ—¶å€™ï¼Œé‡å…¥æ¬¡æ•°ä¸º1<br>å½“æ‰§è¡Œå®Œæˆadd1çš„æ—¶å€™ï¼Œé‡å…¥æ¬¡æ•°ä¸º0ï¼›<br>Qï¼šä¸ºä»€ä¹ˆadd1é‡Œé¢åŠ é”ï¼Œadd2è¿˜è¦åŠ é”å‘¢ï¼Ÿ<br>Aï¼šå› ä¸ºadd2ä¸æ˜¯åªä¼šåœ¨add1é‡Œé¢è°ƒç”¨</p>
<p>redissonå®ç°çš„åˆ†å¸ƒå¼é”-ä¸»ä»ä¸€è‡´æ€§<br>å½“javaåº”ç”¨è·å–é”æ—¶ï¼ŒmasterèŠ‚ç‚¹å®•æœºäº†<br><img src="/Resources/Pasted%20image%2020230601112840.png" srcset="/img/loading.gif" lazyload></p>
<p>æ­¤æ—¶redisä¼šé€‰ä¸¾ä¸€ä¸ªä»èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œç”±äºä¹‹å‰çš„masterå®•æœºäº†ï¼Œè¿˜æ²¡æ¥å¾—åŠæ•°æ®åŒæ­¥ï¼Œæ­¤æ—¶å¦å¤–ä¸€ä¸ªjavaåº”ç”¨è·å–äº†é”ï¼Œé‚£ä¹ˆç°åœ¨å°±ä¼šæœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æŒæœ‰ä¸€æŠŠé”<br><img src="/Resources/Pasted%20image%2020230601112932.png" srcset="/img/loading.gif" lazyload></p>
<p>è§£å†³ï¼š<br><img src="/Resources/Pasted%20image%2020230601113203.png" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Database/" class="category-chain-item">Database</a>
  
  
    <span>></span>
    
  <a href="/categories/Database/Redis/" class="category-chain-item">Redis</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Redis/">#Redis</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Redis</div>
      <div>http://conquers.github.io/posts/bae4ff13.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>wtt</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2022å¹´6æœˆ18æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/posts/9cde3973.html" title="Shiroå®æˆ˜æ•™ç¨‹">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Shiroå®æˆ˜æ•™ç¨‹</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'Conquers/blog-comments');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div style="font-size: 0.85rem"> <span id="timeDate">è½½å…¥å¤©æ•°...</span> <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="busuanzi_value_site_pv"></span>
         æ¬¡
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="busuanzi_value_site_uv"></span>
         äºº
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
